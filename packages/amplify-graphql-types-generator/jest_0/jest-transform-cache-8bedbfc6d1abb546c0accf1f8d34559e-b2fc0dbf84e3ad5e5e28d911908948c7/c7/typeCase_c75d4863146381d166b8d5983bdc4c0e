b2026c53a3594633dca944f0d587ea3a
'use strict';require('ts-jest').install("/c/Users/Sandro/repo/amplify-cli/packages/amplify-graphql-types-generator/test/compiler/visitors/typeCase.ts", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst graphql_1 = require(\"graphql\");\nconst helpers_1 = require(\"../../test-utils/helpers\");\nconst typeCase_1 = require(\"../../../src/compiler/visitors/typeCase\");\nconst collectAndMergeFields_1 = require(\"../../../src/compiler/visitors/collectAndMergeFields\");\nexports.animalSchema = graphql_1.buildSchema(`\n  type Query {\n    animal: Animal\n    catOrBird: CatOrBird\n  }\n\n  union Animal = Cat | Bird | Crocodile | Fish\n  union CatOrBird = Cat | Bird\n\n  interface Pet {\n    name: String!\n  }\n\n  interface WarmBlooded {\n    bodyTemperature: Int!\n  }\n\n  type Cat implements Pet & WarmBlooded {\n    name: String!\n    bodyTemperature: Int!\n  }\n\n  type Bird implements Pet & WarmBlooded {\n    name: String!\n    bodyTemperature: Int!\n  }\n\n  type Fish implements Pet {\n    name: String!\n  }\n\n  type Crocodile {\n    age: Int!\n  }\n`);\ndescribe('TypeCase', () => {\n    it('should recursively include inline fragments with type conditions that match the parent type', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          id\n          ... on Character {\n            name\n            ... on Character {\n              id\n              appearsIn\n            }\n            id\n          }\n        }\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['id', 'name', 'appearsIn']);\n        expect(typeCase.variants).toHaveLength(0);\n        expect(typeCase.exhaustiveVariants).toHaveLength(1);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['id', 'name', 'appearsIn']);\n    });\n    it('should recursively include fragment spreads with type conditions that match the parent type', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          id\n          ...HeroDetails\n        }\n      }\n\n      fragment HeroDetails on Character {\n        name\n        ...MoreHeroDetails\n        id\n      }\n\n      fragment MoreHeroDetails on Character {\n        appearsIn\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['id', 'name', 'appearsIn']);\n        expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['HeroDetails', 'MoreHeroDetails']);\n        expect(typeCase.variants).toHaveLength(0);\n        expect(typeCase.exhaustiveVariants).toHaveLength(1);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['id', 'name', 'appearsIn']);\n    });\n    it('should include fragment spreads when nested within inline fragments', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          ... on Character {\n            ...CharacterName\n          }\n        }\n      }\n\n      fragment CharacterName on Character {\n        name\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);\n        expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['CharacterName']);\n        expect(typeCase.variants).toHaveLength(0);\n    });\n    it('should only include fragment spreads once even if included twice in different subselections', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          friends {\n            ...CharacterName\n          }\n          ... on Droid {\n            friends {\n              ...CharacterName\n            }\n          }\n        }\n      }\n\n      fragment CharacterName on Character {\n        name\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(collectAndMergeFields_1.collectAndMergeFields(typeCase_1.typeCaseForSelectionSet(selectionSet).variants[0])[0].selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);\n        expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['CharacterName']);\n    });\n    it('should ignore type modifiers when matching the parent type', () => {\n        const schema = graphql_1.buildSchema(`\n      type Query {\n        heroes: [Character]\n      }\n\n      interface Character {\n        name: String!\n      }\n\n      type Human implements Character {\n        name: String!\n      }\n\n      type Droid implements Character {\n        name: String!\n      }\n    `);\n        const context = helpers_1.compile(`\n      query Hero {\n        heroes {\n          ... on Character {\n            name\n          }\n        }\n      }\n    `, schema);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);\n        expect(typeCase.variants).toHaveLength(0);\n        expect(typeCase.exhaustiveVariants).toHaveLength(1);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['name']);\n    });\n    it('should merge fields from the default case into type conditions', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          name\n          ... on Droid {\n            primaryFunction\n          }\n          appearsIn\n          ... on Human {\n            height\n          }\n        }\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name', 'appearsIn']);\n        expect(typeCase.variants).toHaveLength(2);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Human'], ['name', 'appearsIn', 'height']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(2);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], ['name', 'appearsIn', 'height']);\n    });\n    it(`should merge fields from type conditions with the same type`, () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          name\n          ... on Droid {\n            primaryFunction\n          }\n          ... on Droid {\n            appearsIn\n          }\n        }\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);\n        expect(typeCase.variants).toHaveLength(1);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(2);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], ['name']);\n    });\n    it('should inherit type condition when nesting an inline fragment in an inline fragment with a more specific type condition', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          ... on Droid {\n            ... on Character {\n              name\n            }\n          }\n        }\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], []);\n        expect(typeCase.variants).toHaveLength(1);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(2);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], []);\n    });\n    it('should not inherit type condition when nesting an inline fragment in an inline fragment with a less specific type condition', () => {\n        const context = helpers_1.compile(`\n      query Hero {\n        hero {\n          ... on Character {\n            ... on Droid {\n              name\n            }\n          }\n        }\n      }\n    `);\n        const selectionSet = context.operations['Hero'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], []);\n        expect(typeCase.variants).toHaveLength(1);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(2);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], []);\n    });\n    it('should merge fields from the parent case into nested type conditions', () => {\n        const context = helpers_1.compile(`\n      query Animal {\n        animal {\n          ... on Pet {\n            name\n            ... on WarmBlooded {\n              bodyTemperature\n            }\n          }\n        }\n      }\n    `, exports.animalSchema);\n        const selectionSet = context.operations['Animal'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird', 'Fish', 'Crocodile'], []);\n        expect(typeCase.variants).toHaveLength(2);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Fish'], ['name']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(3);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Fish'], ['name']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Crocodile'], []);\n    });\n    it('should merge fields from the parent case into nested type conditions', () => {\n        const context = helpers_1.compile(`\n      query Animal {\n        animal {\n          ... on Pet {\n            name\n            ... on WarmBlooded {\n              bodyTemperature\n            }\n          }\n          ... on WarmBlooded {\n            bodyTemperature\n            ... on Pet {\n              name\n            }\n          }\n        }\n      }\n    `, exports.animalSchema);\n        const selectionSet = context.operations['Animal'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird', 'Fish', 'Crocodile'], []);\n        expect(typeCase.variants).toHaveLength(2);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n        expect(typeCase.variants).toContainSelectionSetMatching(['Fish'], ['name']);\n        expect(typeCase.exhaustiveVariants).toHaveLength(3);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Fish'], ['name']);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Crocodile'], []);\n    });\n    it('should not keep type conditions when all possible objects match', () => {\n        const context = helpers_1.compile(`\n      query Animal {\n        catOrBird {\n          ... on Pet {\n            name\n            ... on WarmBlooded {\n              bodyTemperature\n            }\n          }\n        }\n      }\n    `, exports.animalSchema);\n        const selectionSet = context.operations['Animal'].selectionSet.selections[0]\n            .selectionSet;\n        const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);\n        expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n        expect(typeCase.variants).toHaveLength(0);\n        expect(typeCase.exhaustiveVariants).toHaveLength(1);\n        expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);\n    });\n});\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZUNhc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0eXBlQ2FzZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHFDQUFzQztBQUN0QyxzREFBbUQ7QUFHbkQsc0VBQWtGO0FBQ2xGLGdHQUE2RjtBQUVoRixRQUFBLFlBQVksR0FBRyxxQkFBVyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0NBa0N2QyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtJQUN4QixFQUFFLENBQUMsNkZBQTZGLEVBQUUsR0FBRyxFQUFFO1FBQ3JHLE1BQU0sT0FBTyxHQUFHLGlCQUFPLENBQUM7Ozs7Ozs7Ozs7Ozs7O0tBY3ZCLENBQUMsQ0FBQztRQUVILE1BQU0sWUFBWSxHQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQVc7YUFDbEYsWUFBNEIsQ0FBQztRQUNoQyxNQUFNLFFBQVEsR0FBRyxrQ0FBdUIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUV2RCxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBRTlGLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLDZCQUE2QixDQUMvRCxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFDbEIsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLFdBQVcsQ0FB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ZnJvbSAnZ3JhcGhxbCc7XG5pbXBvcnQgeyBjb21waWxlIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9oZWxwZXJzJztcblxuaW1wb3J0IHsgU2VsZWN0aW9uU2V0LCBGaWVsZCB9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21waWxlcic7XG5pbXBvcnQgeyB0eXBlQ2FzZUZvclNlbGVjdGlvblNldCB9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21waWxlci92aXNpdG9ycy90eXBlQ2FzZSc7XG5pbXBvcnQgeyBjb2xsZWN0QW5kTWVyZ2VGaWVsZHMgfSBmcm9tICcuLi8uLi8uLi9zcmMvY29tcGlsZXIvdmlzaXRvcnMvY29sbGVjdEFuZE1lcmdlRmllbGRzJztcblxuZXhwb3J0IGNvbnN0IGFuaW1hbFNjaGVtYSA9IGJ1aWxkU2NoZW1hKGBcbiAgdHlwZSBRdWVyeSB7XG4gICAgYW5pbWFsOiBBbmltYWxcbiAgICBjYXRPckJpcmQ6IENhdE9yQmlyZFxuICB9XG5cbiAgdW5pb24gQW5pbWFsID0gQ2F0IHwgQmlyZCB8IENyb2NvZGlsZSB8IEZpc2hcbiAgdW5pb24gQ2F0T3JCaXJkID0gQ2F0IHwgQmlyZFxuXG4gIGludGVyZmFjZSBQZXQge1xuICAgIG5hbWU6IFN0cmluZyFcbiAgfVxuXG4gIGludGVyZmFjZSBXYXJtQmxvb2RlZCB7XG4gICAgYm9keVRlbXBlcmF0dXJlOiBJbnQhXG4gIH1cblxuICB0eXBlIENhdCBpbXBsZW1lbnRzIFBldCAmIFdhcm1CbG9vZGVkIHtcbiAgICBuYW1lOiBTdHJpbmchXG4gICAgYm9keVRlbXBlcmF0dXJlOiBJbnQhXG4gIH1cblxuICB0eXBlIEJpcmQgaW1wbGVtZW50cyBQZXQgJiBXYXJtQmxvb2RlZCB7XG4gICAgbmFtZTogU3RyaW5nIVxuICAgIGJvZHlUZW1wZXJhdHVyZTogSW50IVxuICB9XG5cbiAgdHlwZSBGaXNoIGltcGxlbWVudHMgUGV0IHtcbiAgICBuYW1lOiBTdHJpbmchXG4gIH1cblxuICB0eXBlIENyb2NvZGlsZSB7XG4gICAgYWdlOiBJbnQhXG4gIH1cbmApO1xuXG5kZXNjcmliZSgnVHlwZUNhc2UnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgcmVjdXJzaXZlbHkgaW5jbHVkZSBpbmxpbmUgZnJhZ21lbnRzIHdpdGggdHlwZSBjb25kaXRpb25zIHRoYXQgbWF0Y2ggdGhlIHBhcmVudCB0eXBlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKGBcbiAgICAgIHF1ZXJ5IEhlcm8ge1xuICAgICAgICBoZXJvIHtcbiAgICAgICAgICBpZFxuICAgICAgICAgIC4uLiBvbiBDaGFyYWN0ZXIge1xuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgIGFwcGVhcnNJblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgWydpZCcsICduYW1lJywgJ2FwcGVhcnNJbiddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydIdW1hbicsICdEcm9pZCddLFxuICAgICAgWydpZCcsICduYW1lJywgJ2FwcGVhcnNJbiddXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZWN1cnNpdmVseSBpbmNsdWRlIGZyYWdtZW50IHNwcmVhZHMgd2l0aCB0eXBlIGNvbmRpdGlvbnMgdGhhdCBtYXRjaCB0aGUgcGFyZW50IHR5cGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm8ge1xuICAgICAgICAgIGlkXG4gICAgICAgICAgLi4uSGVyb0RldGFpbHNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmcmFnbWVudCBIZXJvRGV0YWlscyBvbiBDaGFyYWN0ZXIge1xuICAgICAgICBuYW1lXG4gICAgICAgIC4uLk1vcmVIZXJvRGV0YWlsc1xuICAgICAgICBpZFxuICAgICAgfVxuXG4gICAgICBmcmFnbWVudCBNb3JlSGVyb0RldGFpbHMgb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgYXBwZWFyc0luXG4gICAgICB9XG4gICAgYCk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydIZXJvJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFsnaWQnLCAnbmFtZScsICdhcHBlYXJzSW4nXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQuZnJhZ21lbnRTcHJlYWRzLm1hcChmcmFnbWVudFNwcmVhZCA9PiBmcmFnbWVudFNwcmVhZC5mcmFnbWVudE5hbWUpKS50b0VxdWFsKFsnSGVyb0RldGFpbHMnLCAnTW9yZUhlcm9EZXRhaWxzJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0h1bWFuJywgJ0Ryb2lkJ10sXG4gICAgICBbJ2lkJywgJ25hbWUnLCAnYXBwZWFyc0luJ11cbiAgICApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGluY2x1ZGUgZnJhZ21lbnQgc3ByZWFkcyB3aGVuIG5lc3RlZCB3aXRoaW4gaW5saW5lIGZyYWdtZW50cycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICAuLi5DaGFyYWN0ZXJOYW1lXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZyYWdtZW50IENoYXJhY3Rlck5hbWUgb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgbmFtZVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbJ25hbWUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQuZnJhZ21lbnRTcHJlYWRzLm1hcChmcmFnbWVudFNwcmVhZCA9PiBmcmFnbWVudFNwcmVhZC5mcmFnbWVudE5hbWUpKS50b0VxdWFsKFsnQ2hhcmFjdGVyTmFtZSddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG9ubHkgaW5jbHVkZSBmcmFnbWVudCBzcHJlYWRzIG9uY2UgZXZlbiBpZiBpbmNsdWRlZCB0d2ljZSBpbiBkaWZmZXJlbnQgc3Vic2VsZWN0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgZnJpZW5kcyB7XG4gICAgICAgICAgICAuLi5DaGFyYWN0ZXJOYW1lXG4gICAgICAgICAgfVxuICAgICAgICAgIC4uLiBvbiBEcm9pZCB7XG4gICAgICAgICAgICBmcmllbmRzIHtcbiAgICAgICAgICAgICAgLi4uQ2hhcmFjdGVyTmFtZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmcmFnbWVudCBDaGFyYWN0ZXJOYW1lIG9uIENoYXJhY3RlciB7XG4gICAgICAgIG5hbWVcbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoY29sbGVjdEFuZE1lcmdlRmllbGRzKHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCkudmFyaWFudHNbMF0pWzBdLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbJ25hbWUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQuZnJhZ21lbnRTcHJlYWRzLm1hcChmcmFnbWVudFNwcmVhZCA9PiBmcmFnbWVudFNwcmVhZC5mcmFnbWVudE5hbWUpKS50b0VxdWFsKFsnQ2hhcmFjdGVyTmFtZSddKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBpZ25vcmUgdHlwZSBtb2RpZmllcnMgd2hlbiBtYXRjaGluZyB0aGUgcGFyZW50IHR5cGUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEoYFxuICAgICAgdHlwZSBRdWVyeSB7XG4gICAgICAgIGhlcm9lczogW0NoYXJhY3Rlcl1cbiAgICAgIH1cblxuICAgICAgaW50ZXJmYWNlIENoYXJhY3RlciB7XG4gICAgICAgIG5hbWU6IFN0cmluZyFcbiAgICAgIH1cblxuICAgICAgdHlwZSBIdW1hbiBpbXBsZW1lbnRzIENoYXJhY3RlciB7XG4gICAgICAgIG5hbWU6IFN0cmluZyFcbiAgICAgIH1cblxuICAgICAgdHlwZSBEcm9pZCBpbXBsZW1lbnRzIENoYXJhY3RlciB7XG4gICAgICAgIG5hbWU6IFN0cmluZyFcbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKFxuICAgICAgYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm9lcyB7XG4gICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICBuYW1lXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCxcbiAgICAgIHNjaGVtYVxuICAgICk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydIZXJvJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFsnbmFtZSddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnSHVtYW4nLCAnRHJvaWQnXSwgWyduYW1lJ10pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG1lcmdlIGZpZWxkcyBmcm9tIHRoZSBkZWZhdWx0IGNhc2UgaW50byB0eXBlIGNvbmRpdGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm8ge1xuICAgICAgICAgIG5hbWVcbiAgICAgICAgICAuLi4gb24gRHJvaWQge1xuICAgICAgICAgICAgcHJpbWFyeUZ1bmN0aW9uXG4gICAgICAgICAgfVxuICAgICAgICAgIGFwcGVhcnNJblxuICAgICAgICAgIC4uLiBvbiBIdW1hbiB7XG4gICAgICAgICAgICBoZWlnaHRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgWyduYW1lJywgJ2FwcGVhcnNJbiddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0Ryb2lkJ10sXG4gICAgICBbJ25hbWUnLCAncHJpbWFyeUZ1bmN0aW9uJywgJ2FwcGVhcnNJbiddXG4gICAgKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnSHVtYW4nXSwgWyduYW1lJywgJ2FwcGVhcnNJbicsICdoZWlnaHQnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0Ryb2lkJ10sXG4gICAgICBbJ25hbWUnLCAncHJpbWFyeUZ1bmN0aW9uJywgJ2FwcGVhcnNJbiddXG4gICAgKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnSHVtYW4nXSxcbiAgICAgIFsnbmFtZScsICdhcHBlYXJzSW4nLCAnaGVpZ2h0J11cbiAgICApO1xuICB9KTtcblxuICBpdChgc2hvdWxkIG1lcmdlIGZpZWxkcyBmcm9tIHR5cGUgY29uZGl0aW9ucyB3aXRoIHRoZSBzYW1lIHR5cGVgLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm8ge1xuICAgICAgICAgIG5hbWVcbiAgICAgICAgICAuLi4gb24gRHJvaWQge1xuICAgICAgICAgICAgcHJpbWFyeUZ1bmN0aW9uXG4gICAgICAgICAgfVxuICAgICAgICAgIC4uLiBvbiBEcm9pZCB7XG4gICAgICAgICAgICBhcHBlYXJzSW5cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgWyduYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnRHJvaWQnXSxcbiAgICAgIFsnbmFtZScsICdwcmltYXJ5RnVuY3Rpb24nLCAnYXBwZWFyc0luJ11cbiAgICApO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydEcm9pZCddLFxuICAgICAgWyduYW1lJywgJ3ByaW1hcnlGdW5jdGlvbicsICdhcHBlYXJzSW4nXVxuICAgICk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydIdW1hbiddLCBbJ25hbWUnXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaW5oZXJpdCB0eXBlIGNvbmRpdGlvbiB3aGVuIG5lc3RpbmcgYW4gaW5saW5lIGZyYWdtZW50IGluIGFuIGlubGluZSBmcmFnbWVudCB3aXRoIGEgbW9yZSBzcGVjaWZpYyB0eXBlIGNvbmRpdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgLi4uIG9uIERyb2lkIHtcbiAgICAgICAgICAgIC4uLiBvbiBDaGFyYWN0ZXIge1xuICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydIZXJvJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFtdKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydEcm9pZCddLCBbJ25hbWUnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydEcm9pZCddLCBbJ25hbWUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydIdW1hbiddLCBbXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbm90IGluaGVyaXQgdHlwZSBjb25kaXRpb24gd2hlbiBuZXN0aW5nIGFuIGlubGluZSBmcmFnbWVudCBpbiBhbiBpbmxpbmUgZnJhZ21lbnQgd2l0aCBhIGxlc3Mgc3BlY2lmaWMgdHlwZSBjb25kaXRpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm8ge1xuICAgICAgICAgIC4uLiBvbiBDaGFyYWN0ZXIge1xuICAgICAgICAgICAgLi4uIG9uIERyb2lkIHtcbiAgICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnRHJvaWQnXSwgWyduYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnRHJvaWQnXSwgWyduYW1lJ10pO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnSHVtYW4nXSwgW10pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG1lcmdlIGZpZWxkcyBmcm9tIHRoZSBwYXJlbnQgY2FzZSBpbnRvIG5lc3RlZCB0eXBlIGNvbmRpdGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoXG4gICAgICBgXG4gICAgICBxdWVyeSBBbmltYWwge1xuICAgICAgICBhbmltYWwge1xuICAgICAgICAgIC4uLiBvbiBQZXQge1xuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgLi4uIG9uIFdhcm1CbG9vZGVkIHtcbiAgICAgICAgICAgICAgYm9keVRlbXBlcmF0dXJlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCxcbiAgICAgIGFuaW1hbFNjaGVtYVxuICAgICk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydBbmltYWwnXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnQ2F0JywgJ0JpcmQnLCAnRmlzaCcsICdDcm9jb2RpbGUnXSwgW10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0NhdCcsICdCaXJkJ10sIFsnbmFtZScsICdib2R5VGVtcGVyYXR1cmUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Zpc2gnXSwgWyduYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDMpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydDYXQnLCAnQmlyZCddLFxuICAgICAgWyduYW1lJywgJ2JvZHlUZW1wZXJhdHVyZSddXG4gICAgKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Zpc2gnXSwgWyduYW1lJ10pO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnQ3JvY29kaWxlJ10sIFtdKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBtZXJnZSBmaWVsZHMgZnJvbSB0aGUgcGFyZW50IGNhc2UgaW50byBuZXN0ZWQgdHlwZSBjb25kaXRpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKFxuICAgICAgYFxuICAgICAgcXVlcnkgQW5pbWFsIHtcbiAgICAgICAgYW5pbWFsIHtcbiAgICAgICAgICAuLi4gb24gUGV0IHtcbiAgICAgICAgICAgIG5hbWVcbiAgICAgICAgICAgIC4uLiBvbiBXYXJtQmxvb2RlZCB7XG4gICAgICAgICAgICAgIGJvZHlUZW1wZXJhdHVyZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAuLi4gb24gV2FybUJsb29kZWQge1xuICAgICAgICAgICAgYm9keVRlbXBlcmF0dXJlXG4gICAgICAgICAgICAuLi4gb24gUGV0IHtcbiAgICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIGAsXG4gICAgICBhbmltYWxTY2hlbWFcbiAgICApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snQW5pbWFsJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0NhdCcsICdCaXJkJywgJ0Zpc2gnLCAnQ3JvY29kaWxlJ10sIFtdKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydDYXQnLCAnQmlyZCddLCBbJ25hbWUnLCAnYm9keVRlbXBlcmF0dXJlJ10pO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydGaXNoJ10sIFsnbmFtZSddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnQ2F0JywgJ0JpcmQnXSxcbiAgICAgIFsnbmFtZScsICdib2R5VGVtcGVyYXR1cmUnXVxuICAgICk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydGaXNoJ10sIFsnbmFtZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Nyb2NvZGlsZSddLCBbXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbm90IGtlZXAgdHlwZSBjb25kaXRpb25zIHdoZW4gYWxsIHBvc3NpYmxlIG9iamVjdHMgbWF0Y2gnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoXG4gICAgICBgXG4gICAgICBxdWVyeSBBbmltYWwge1xuICAgICAgICBjYXRPckJpcmQge1xuICAgICAgICAgIC4uLiBvbiBQZXQge1xuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgLi4uIG9uIFdhcm1CbG9vZGVkIHtcbiAgICAgICAgICAgICAgYm9keVRlbXBlcmF0dXJlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCxcbiAgICAgIGFuaW1hbFNjaGVtYVxuICAgICk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydBbmltYWwnXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnQ2F0JywgJ0JpcmQnXSwgWyduYW1lJywgJ2JvZHlUZW1wZXJhdHVyZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnQ2F0JywgJ0JpcmQnXSxcbiAgICAgIFsnbmFtZScsICdib2R5VGVtcGVyYXR1cmUnXVxuICAgICk7XG4gIH0pO1xufSk7XG4iXX0=");"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const graphql_1 = require("graphql");
const helpers_1 = require("../../test-utils/helpers");
const typeCase_1 = require("../../../src/compiler/visitors/typeCase");
const collectAndMergeFields_1 = require("../../../src/compiler/visitors/collectAndMergeFields");
exports.animalSchema = graphql_1.buildSchema(`
  type Query {
    animal: Animal
    catOrBird: CatOrBird
  }

  union Animal = Cat | Bird | Crocodile | Fish
  union CatOrBird = Cat | Bird

  interface Pet {
    name: String!
  }

  interface WarmBlooded {
    bodyTemperature: Int!
  }

  type Cat implements Pet & WarmBlooded {
    name: String!
    bodyTemperature: Int!
  }

  type Bird implements Pet & WarmBlooded {
    name: String!
    bodyTemperature: Int!
  }

  type Fish implements Pet {
    name: String!
  }

  type Crocodile {
    age: Int!
  }
`);
describe('TypeCase', () => {
  it('should recursively include inline fragments with type conditions that match the parent type', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          id
          ... on Character {
            name
            ... on Character {
              id
              appearsIn
            }
            id
          }
        }
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['id', 'name', 'appearsIn']);
    expect(typeCase.variants).toHaveLength(0);
    expect(typeCase.exhaustiveVariants).toHaveLength(1);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['id', 'name', 'appearsIn']);
  });
  it('should recursively include fragment spreads with type conditions that match the parent type', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          id
          ...HeroDetails
        }
      }

      fragment HeroDetails on Character {
        name
        ...MoreHeroDetails
        id
      }

      fragment MoreHeroDetails on Character {
        appearsIn
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['id', 'name', 'appearsIn']);
    expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['HeroDetails', 'MoreHeroDetails']);
    expect(typeCase.variants).toHaveLength(0);
    expect(typeCase.exhaustiveVariants).toHaveLength(1);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['id', 'name', 'appearsIn']);
  });
  it('should include fragment spreads when nested within inline fragments', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          ... on Character {
            ...CharacterName
          }
        }
      }

      fragment CharacterName on Character {
        name
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);
    expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['CharacterName']);
    expect(typeCase.variants).toHaveLength(0);
  });
  it('should only include fragment spreads once even if included twice in different subselections', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          friends {
            ...CharacterName
          }
          ... on Droid {
            friends {
              ...CharacterName
            }
          }
        }
      }

      fragment CharacterName on Character {
        name
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(collectAndMergeFields_1.collectAndMergeFields(typeCase_1.typeCaseForSelectionSet(selectionSet).variants[0])[0].selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);
    expect(typeCase.default.fragmentSpreads.map(fragmentSpread => fragmentSpread.fragmentName)).toEqual(['CharacterName']);
  });
  it('should ignore type modifiers when matching the parent type', () => {
    const schema = graphql_1.buildSchema(`
      type Query {
        heroes: [Character]
      }

      interface Character {
        name: String!
      }

      type Human implements Character {
        name: String!
      }

      type Droid implements Character {
        name: String!
      }
    `);
    const context = helpers_1.compile(`
      query Hero {
        heroes {
          ... on Character {
            name
          }
        }
      }
    `, schema);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);
    expect(typeCase.variants).toHaveLength(0);
    expect(typeCase.exhaustiveVariants).toHaveLength(1);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human', 'Droid'], ['name']);
  });
  it('should merge fields from the default case into type conditions', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          name
          ... on Droid {
            primaryFunction
          }
          appearsIn
          ... on Human {
            height
          }
        }
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name', 'appearsIn']);
    expect(typeCase.variants).toHaveLength(2);
    expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);
    expect(typeCase.variants).toContainSelectionSetMatching(['Human'], ['name', 'appearsIn', 'height']);
    expect(typeCase.exhaustiveVariants).toHaveLength(2);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], ['name', 'appearsIn', 'height']);
  });
  it(`should merge fields from type conditions with the same type`, () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          name
          ... on Droid {
            primaryFunction
          }
          ... on Droid {
            appearsIn
          }
        }
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], ['name']);
    expect(typeCase.variants).toHaveLength(1);
    expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);
    expect(typeCase.exhaustiveVariants).toHaveLength(2);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name', 'primaryFunction', 'appearsIn']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], ['name']);
  });
  it('should inherit type condition when nesting an inline fragment in an inline fragment with a more specific type condition', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          ... on Droid {
            ... on Character {
              name
            }
          }
        }
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], []);
    expect(typeCase.variants).toHaveLength(1);
    expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name']);
    expect(typeCase.exhaustiveVariants).toHaveLength(2);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], []);
  });
  it('should not inherit type condition when nesting an inline fragment in an inline fragment with a less specific type condition', () => {
    const context = helpers_1.compile(`
      query Hero {
        hero {
          ... on Character {
            ... on Droid {
              name
            }
          }
        }
      }
    `);
    const selectionSet = context.operations['Hero'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Human', 'Droid'], []);
    expect(typeCase.variants).toHaveLength(1);
    expect(typeCase.variants).toContainSelectionSetMatching(['Droid'], ['name']);
    expect(typeCase.exhaustiveVariants).toHaveLength(2);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Droid'], ['name']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Human'], []);
  });
  it('should merge fields from the parent case into nested type conditions', () => {
    const context = helpers_1.compile(`
      query Animal {
        animal {
          ... on Pet {
            name
            ... on WarmBlooded {
              bodyTemperature
            }
          }
        }
      }
    `, exports.animalSchema);
    const selectionSet = context.operations['Animal'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird', 'Fish', 'Crocodile'], []);
    expect(typeCase.variants).toHaveLength(2);
    expect(typeCase.variants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);
    expect(typeCase.variants).toContainSelectionSetMatching(['Fish'], ['name']);
    expect(typeCase.exhaustiveVariants).toHaveLength(3);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Fish'], ['name']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Crocodile'], []);
  });
  it('should merge fields from the parent case into nested type conditions', () => {
    const context = helpers_1.compile(`
      query Animal {
        animal {
          ... on Pet {
            name
            ... on WarmBlooded {
              bodyTemperature
            }
          }
          ... on WarmBlooded {
            bodyTemperature
            ... on Pet {
              name
            }
          }
        }
      }
    `, exports.animalSchema);
    const selectionSet = context.operations['Animal'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird', 'Fish', 'Crocodile'], []);
    expect(typeCase.variants).toHaveLength(2);
    expect(typeCase.variants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);
    expect(typeCase.variants).toContainSelectionSetMatching(['Fish'], ['name']);
    expect(typeCase.exhaustiveVariants).toHaveLength(3);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Fish'], ['name']);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Crocodile'], []);
  });
  it('should not keep type conditions when all possible objects match', () => {
    const context = helpers_1.compile(`
      query Animal {
        catOrBird {
          ... on Pet {
            name
            ... on WarmBlooded {
              bodyTemperature
            }
          }
        }
      }
    `, exports.animalSchema);
    const selectionSet = context.operations['Animal'].selectionSet.selections[0].
    selectionSet;
    const typeCase = typeCase_1.typeCaseForSelectionSet(selectionSet);
    expect(typeCase.default).toMatchSelectionSet(['Cat', 'Bird'], ['name', 'bodyTemperature']);
    expect(typeCase.variants).toHaveLength(0);
    expect(typeCase.exhaustiveVariants).toHaveLength(1);
    expect(typeCase.exhaustiveVariants).toContainSelectionSetMatching(['Cat', 'Bird'], ['name', 'bodyTemperature']);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNFLENBQUMsS0FBRCxFQUFRLE1BQVIsQ0FERixFQUVFLENBQUMsTUFBRCxFQUFTLGlCQUFULENBRkY7QUFJQSxXQUFPLFNBQVMsa0JBQWhCLEVBQW9DLDZCQUFwQyxDQUFrRSxDQUFDLE1BQUQsQ0FBbEUsRUFBNEUsQ0FBQyxNQUFELENBQTVFO0FBQ0EsV0FBTyxTQUFTLGtCQUFoQixFQUFvQyw2QkFBcEMsQ0FBa0UsQ0FBQyxXQUFELENBQWxFLEVBQWlGLEVBQWpGO0FBQ0QsR0F4Q0Q7QUEwQ0EsS0FBRyxpRUFBSCxFQUFzRSxNQUFLO0FBQ3pFLFVBQU0sVUFBVSxVQUFBLE9BQUEsQ0FDZDs7Ozs7Ozs7Ozs7S0FEYyxFQWFkLFFBQUEsWUFiYyxDQUFoQjtBQWdCQSxVQUFNLGVBQWdCLFFBQVEsVUFBUixDQUFtQixRQUFuQixFQUE2QixZQUE3QixDQUEwQyxVQUExQyxDQUFxRCxDQUFyRDtBQUNuQixnQkFESDtBQUVBLFVBQU0sV0FBVyxXQUFBLHVCQUFBLENBQXdCLFlBQXhCLENBQWpCO0FBRUEsV0FBTyxTQUFTLE9BQWhCLEVBQXlCLG1CQUF6QixDQUE2QyxDQUFDLEtBQUQsRUFBUSxNQUFSLENBQTdDLEVBQThELENBQUMsTUFBRCxFQUFTLGlCQUFULENBQTlEO0FBQ0EsV0FBTyxTQUFTLFFBQWhCLEVBQTBCLFlBQTFCLENBQXVDLENBQXZDO0FBRUEsV0FBTyxTQUFTLGtCQUFoQixFQUFvQyxZQUFwQyxDQUFpRCxDQUFqRDtBQUNBLFdBQU8sU0FBUyxrQkFBaEIsRUFBb0MsNkJBQXBDLENBQ0UsQ0FBQyxLQUFELEVBQVEsTUFBUixDQURGLEVBRUUsQ0FBQyxNQUFELEVBQVMsaUJBQVQsQ0FGRjtBQUlELEdBN0JEO0FBOEJELENBblpEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYnVpbGRTY2hlbWEgfSBmcm9tICdncmFwaHFsJztcbmltcG9ydCB7IGNvbXBpbGUgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2hlbHBlcnMnO1xuXG5pbXBvcnQgeyBTZWxlY3Rpb25TZXQsIEZpZWxkIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBpbGVyJztcbmltcG9ydCB7IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0IH0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBpbGVyL3Zpc2l0b3JzL3R5cGVDYXNlJztcbmltcG9ydCB7IGNvbGxlY3RBbmRNZXJnZUZpZWxkcyB9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21waWxlci92aXNpdG9ycy9jb2xsZWN0QW5kTWVyZ2VGaWVsZHMnO1xuXG5leHBvcnQgY29uc3QgYW5pbWFsU2NoZW1hID0gYnVpbGRTY2hlbWEoYFxuICB0eXBlIFF1ZXJ5IHtcbiAgICBhbmltYWw6IEFuaW1hbFxuICAgIGNhdE9yQmlyZDogQ2F0T3JCaXJkXG4gIH1cblxuICB1bmlvbiBBbmltYWwgPSBDYXQgfCBCaXJkIHwgQ3JvY29kaWxlIHwgRmlzaFxuICB1bmlvbiBDYXRPckJpcmQgPSBDYXQgfCBCaXJkXG5cbiAgaW50ZXJmYWNlIFBldCB7XG4gICAgbmFtZTogU3RyaW5nIVxuICB9XG5cbiAgaW50ZXJmYWNlIFdhcm1CbG9vZGVkIHtcbiAgICBib2R5VGVtcGVyYXR1cmU6IEludCFcbiAgfVxuXG4gIHR5cGUgQ2F0IGltcGxlbWVudHMgUGV0ICYgV2FybUJsb29kZWQge1xuICAgIG5hbWU6IFN0cmluZyFcbiAgICBib2R5VGVtcGVyYXR1cmU6IEludCFcbiAgfVxuXG4gIHR5cGUgQmlyZCBpbXBsZW1lbnRzIFBldCAmIFdhcm1CbG9vZGVkIHtcbiAgICBuYW1lOiBTdHJpbmchXG4gICAgYm9keVRlbXBlcmF0dXJlOiBJbnQhXG4gIH1cblxuICB0eXBlIEZpc2ggaW1wbGVtZW50cyBQZXQge1xuICAgIG5hbWU6IFN0cmluZyFcbiAgfVxuXG4gIHR5cGUgQ3JvY29kaWxlIHtcbiAgICBhZ2U6IEludCFcbiAgfVxuYCk7XG5cbmRlc2NyaWJlKCdUeXBlQ2FzZScsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCByZWN1cnNpdmVseSBpbmNsdWRlIGlubGluZSBmcmFnbWVudHMgd2l0aCB0eXBlIGNvbmRpdGlvbnMgdGhhdCBtYXRjaCB0aGUgcGFyZW50IHR5cGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoYFxuICAgICAgcXVlcnkgSGVybyB7XG4gICAgICAgIGhlcm8ge1xuICAgICAgICAgIGlkXG4gICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICAuLi4gb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgICAgICAgaWRcbiAgICAgICAgICAgICAgYXBwZWFyc0luXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbJ2lkJywgJ25hbWUnLCAnYXBwZWFyc0luJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0h1bWFuJywgJ0Ryb2lkJ10sXG4gICAgICBbJ2lkJywgJ25hbWUnLCAnYXBwZWFyc0luJ11cbiAgICApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJlY3Vyc2l2ZWx5IGluY2x1ZGUgZnJhZ21lbnQgc3ByZWFkcyB3aXRoIHR5cGUgY29uZGl0aW9ucyB0aGF0IG1hdGNoIHRoZSBwYXJlbnQgdHlwZScsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgaWRcbiAgICAgICAgICAuLi5IZXJvRGV0YWlsc1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZyYWdtZW50IEhlcm9EZXRhaWxzIG9uIENoYXJhY3RlciB7XG4gICAgICAgIG5hbWVcbiAgICAgICAgLi4uTW9yZUhlcm9EZXRhaWxzXG4gICAgICAgIGlkXG4gICAgICB9XG5cbiAgICAgIGZyYWdtZW50IE1vcmVIZXJvRGV0YWlscyBvbiBDaGFyYWN0ZXIge1xuICAgICAgICBhcHBlYXJzSW5cbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgWydpZCcsICduYW1lJywgJ2FwcGVhcnNJbiddKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdC5mcmFnbWVudFNwcmVhZHMubWFwKGZyYWdtZW50U3ByZWFkID0+IGZyYWdtZW50U3ByZWFkLmZyYWdtZW50TmFtZSkpLnRvRXF1YWwoWydIZXJvRGV0YWlscycsICdNb3JlSGVyb0RldGFpbHMnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnSHVtYW4nLCAnRHJvaWQnXSxcbiAgICAgIFsnaWQnLCAnbmFtZScsICdhcHBlYXJzSW4nXVxuICAgICk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaW5jbHVkZSBmcmFnbWVudCBzcHJlYWRzIHdoZW4gbmVzdGVkIHdpdGhpbiBpbmxpbmUgZnJhZ21lbnRzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKGBcbiAgICAgIHF1ZXJ5IEhlcm8ge1xuICAgICAgICBoZXJvIHtcbiAgICAgICAgICAuLi4gb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgICAgIC4uLkNoYXJhY3Rlck5hbWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnJhZ21lbnQgQ2hhcmFjdGVyTmFtZSBvbiBDaGFyYWN0ZXIge1xuICAgICAgICBuYW1lXG4gICAgICB9XG4gICAgYCk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydIZXJvJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFsnbmFtZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdC5mcmFnbWVudFNwcmVhZHMubWFwKGZyYWdtZW50U3ByZWFkID0+IGZyYWdtZW50U3ByZWFkLmZyYWdtZW50TmFtZSkpLnRvRXF1YWwoWydDaGFyYWN0ZXJOYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgb25seSBpbmNsdWRlIGZyYWdtZW50IHNwcmVhZHMgb25jZSBldmVuIGlmIGluY2x1ZGVkIHR3aWNlIGluIGRpZmZlcmVudCBzdWJzZWxlY3Rpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKGBcbiAgICAgIHF1ZXJ5IEhlcm8ge1xuICAgICAgICBoZXJvIHtcbiAgICAgICAgICBmcmllbmRzIHtcbiAgICAgICAgICAgIC4uLkNoYXJhY3Rlck5hbWVcbiAgICAgICAgICB9XG4gICAgICAgICAgLi4uIG9uIERyb2lkIHtcbiAgICAgICAgICAgIGZyaWVuZHMge1xuICAgICAgICAgICAgICAuLi5DaGFyYWN0ZXJOYW1lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZyYWdtZW50IENoYXJhY3Rlck5hbWUgb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgbmFtZVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChjb2xsZWN0QW5kTWVyZ2VGaWVsZHModHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KS52YXJpYW50c1swXSlbMF0uc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFsnbmFtZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdC5mcmFnbWVudFNwcmVhZHMubWFwKGZyYWdtZW50U3ByZWFkID0+IGZyYWdtZW50U3ByZWFkLmZyYWdtZW50TmFtZSkpLnRvRXF1YWwoWydDaGFyYWN0ZXJOYW1lJ10pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGlnbm9yZSB0eXBlIG1vZGlmaWVycyB3aGVuIG1hdGNoaW5nIHRoZSBwYXJlbnQgdHlwZScsICgpID0+IHtcbiAgICBjb25zdCBzY2hlbWEgPSBidWlsZFNjaGVtYShgXG4gICAgICB0eXBlIFF1ZXJ5IHtcbiAgICAgICAgaGVyb2VzOiBbQ2hhcmFjdGVyXVxuICAgICAgfVxuXG4gICAgICBpbnRlcmZhY2UgQ2hhcmFjdGVyIHtcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgfVxuXG4gICAgICB0eXBlIEh1bWFuIGltcGxlbWVudHMgQ2hhcmFjdGVyIHtcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgfVxuXG4gICAgICB0eXBlIERyb2lkIGltcGxlbWVudHMgQ2hhcmFjdGVyIHtcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoXG4gICAgICBgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVyb2VzIHtcbiAgICAgICAgICAuLi4gb24gQ2hhcmFjdGVyIHtcbiAgICAgICAgICAgIG5hbWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgLFxuICAgICAgc2NoZW1hXG4gICAgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgWyduYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydIdW1hbicsICdEcm9pZCddLCBbJ25hbWUnXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbWVyZ2UgZmllbGRzIGZyb20gdGhlIGRlZmF1bHQgY2FzZSBpbnRvIHR5cGUgY29uZGl0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgbmFtZVxuICAgICAgICAgIC4uLiBvbiBEcm9pZCB7XG4gICAgICAgICAgICBwcmltYXJ5RnVuY3Rpb25cbiAgICAgICAgICB9XG4gICAgICAgICAgYXBwZWFyc0luXG4gICAgICAgICAgLi4uIG9uIEh1bWFuIHtcbiAgICAgICAgICAgIGhlaWdodFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbJ25hbWUnLCAnYXBwZWFyc0luJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnRHJvaWQnXSxcbiAgICAgIFsnbmFtZScsICdwcmltYXJ5RnVuY3Rpb24nLCAnYXBwZWFyc0luJ11cbiAgICApO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydIdW1hbiddLCBbJ25hbWUnLCAnYXBwZWFyc0luJywgJ2hlaWdodCddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhcbiAgICAgIFsnRHJvaWQnXSxcbiAgICAgIFsnbmFtZScsICdwcmltYXJ5RnVuY3Rpb24nLCAnYXBwZWFyc0luJ11cbiAgICApO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydIdW1hbiddLFxuICAgICAgWyduYW1lJywgJ2FwcGVhcnNJbicsICdoZWlnaHQnXVxuICAgICk7XG4gIH0pO1xuXG4gIGl0KGBzaG91bGQgbWVyZ2UgZmllbGRzIGZyb20gdHlwZSBjb25kaXRpb25zIHdpdGggdGhlIHNhbWUgdHlwZWAsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgbmFtZVxuICAgICAgICAgIC4uLiBvbiBEcm9pZCB7XG4gICAgICAgICAgICBwcmltYXJ5RnVuY3Rpb25cbiAgICAgICAgICB9XG4gICAgICAgICAgLi4uIG9uIERyb2lkIHtcbiAgICAgICAgICAgIGFwcGVhcnNJblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIGApO1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uU2V0ID0gKGNvbnRleHQub3BlcmF0aW9uc1snSGVybyddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydIdW1hbicsICdEcm9pZCddLCBbJ25hbWUnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydEcm9pZCddLFxuICAgICAgWyduYW1lJywgJ3ByaW1hcnlGdW5jdGlvbicsICdhcHBlYXJzSW4nXVxuICAgICk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0Ryb2lkJ10sXG4gICAgICBbJ25hbWUnLCAncHJpbWFyeUZ1bmN0aW9uJywgJ2FwcGVhcnNJbiddXG4gICAgKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0h1bWFuJ10sIFsnbmFtZSddKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBpbmhlcml0IHR5cGUgY29uZGl0aW9uIHdoZW4gbmVzdGluZyBhbiBpbmxpbmUgZnJhZ21lbnQgaW4gYW4gaW5saW5lIGZyYWdtZW50IHdpdGggYSBtb3JlIHNwZWNpZmljIHR5cGUgY29uZGl0aW9uJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBjb21waWxlKGBcbiAgICAgIHF1ZXJ5IEhlcm8ge1xuICAgICAgICBoZXJvIHtcbiAgICAgICAgICAuLi4gb24gRHJvaWQge1xuICAgICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICAgIG5hbWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0hlcm8nXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnSHVtYW4nLCAnRHJvaWQnXSwgW10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Ryb2lkJ10sIFsnbmFtZSddKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Ryb2lkJ10sIFsnbmFtZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0h1bWFuJ10sIFtdKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgaW5oZXJpdCB0eXBlIGNvbmRpdGlvbiB3aGVuIG5lc3RpbmcgYW4gaW5saW5lIGZyYWdtZW50IGluIGFuIGlubGluZSBmcmFnbWVudCB3aXRoIGEgbGVzcyBzcGVjaWZpYyB0eXBlIGNvbmRpdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShgXG4gICAgICBxdWVyeSBIZXJvIHtcbiAgICAgICAgaGVybyB7XG4gICAgICAgICAgLi4uIG9uIENoYXJhY3RlciB7XG4gICAgICAgICAgICAuLi4gb24gRHJvaWQge1xuICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydIZXJvJ10uc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnNbMF0gYXMgRmllbGQpXG4gICAgICAuc2VsZWN0aW9uU2V0IGFzIFNlbGVjdGlvblNldDtcbiAgICBjb25zdCB0eXBlQ2FzZSA9IHR5cGVDYXNlRm9yU2VsZWN0aW9uU2V0KHNlbGVjdGlvblNldCk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZGVmYXVsdCkudG9NYXRjaFNlbGVjdGlvblNldChbJ0h1bWFuJywgJ0Ryb2lkJ10sIFtdKTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydEcm9pZCddLCBbJ25hbWUnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydEcm9pZCddLCBbJ25hbWUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydIdW1hbiddLCBbXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbWVyZ2UgZmllbGRzIGZyb20gdGhlIHBhcmVudCBjYXNlIGludG8gbmVzdGVkIHR5cGUgY29uZGl0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShcbiAgICAgIGBcbiAgICAgIHF1ZXJ5IEFuaW1hbCB7XG4gICAgICAgIGFuaW1hbCB7XG4gICAgICAgICAgLi4uIG9uIFBldCB7XG4gICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICAuLi4gb24gV2FybUJsb29kZWQge1xuICAgICAgICAgICAgICBib2R5VGVtcGVyYXR1cmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgLFxuICAgICAgYW5pbWFsU2NoZW1hXG4gICAgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0FuaW1hbCddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydDYXQnLCAnQmlyZCcsICdGaXNoJywgJ0Nyb2NvZGlsZSddLCBbXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnQ2F0JywgJ0JpcmQnXSwgWyduYW1lJywgJ2JvZHlUZW1wZXJhdHVyZSddKTtcbiAgICBleHBlY3QodHlwZUNhc2UudmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnRmlzaCddLCBbJ25hbWUnXSk7XG5cbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoXG4gICAgICBbJ0NhdCcsICdCaXJkJ10sXG4gICAgICBbJ25hbWUnLCAnYm9keVRlbXBlcmF0dXJlJ11cbiAgICApO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnRmlzaCddLCBbJ25hbWUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9Db250YWluU2VsZWN0aW9uU2V0TWF0Y2hpbmcoWydDcm9jb2RpbGUnXSwgW10pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG1lcmdlIGZpZWxkcyBmcm9tIHRoZSBwYXJlbnQgY2FzZSBpbnRvIG5lc3RlZCB0eXBlIGNvbmRpdGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IGNvbXBpbGUoXG4gICAgICBgXG4gICAgICBxdWVyeSBBbmltYWwge1xuICAgICAgICBhbmltYWwge1xuICAgICAgICAgIC4uLiBvbiBQZXQge1xuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgLi4uIG9uIFdhcm1CbG9vZGVkIHtcbiAgICAgICAgICAgICAgYm9keVRlbXBlcmF0dXJlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC4uLiBvbiBXYXJtQmxvb2RlZCB7XG4gICAgICAgICAgICBib2R5VGVtcGVyYXR1cmVcbiAgICAgICAgICAgIC4uLiBvbiBQZXQge1xuICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgYCxcbiAgICAgIGFuaW1hbFNjaGVtYVxuICAgICk7XG5cbiAgICBjb25zdCBzZWxlY3Rpb25TZXQgPSAoY29udGV4dC5vcGVyYXRpb25zWydBbmltYWwnXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc1swXSBhcyBGaWVsZClcbiAgICAgIC5zZWxlY3Rpb25TZXQgYXMgU2VsZWN0aW9uU2V0O1xuICAgIGNvbnN0IHR5cGVDYXNlID0gdHlwZUNhc2VGb3JTZWxlY3Rpb25TZXQoc2VsZWN0aW9uU2V0KTtcblxuICAgIGV4cGVjdCh0eXBlQ2FzZS5kZWZhdWx0KS50b01hdGNoU2VsZWN0aW9uU2V0KFsnQ2F0JywgJ0JpcmQnLCAnRmlzaCcsICdDcm9jb2RpbGUnXSwgW10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0NhdCcsICdCaXJkJ10sIFsnbmFtZScsICdib2R5VGVtcGVyYXR1cmUnXSk7XG4gICAgZXhwZWN0KHR5cGVDYXNlLnZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Zpc2gnXSwgWyduYW1lJ10pO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDMpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydDYXQnLCAnQmlyZCddLFxuICAgICAgWyduYW1lJywgJ2JvZHlUZW1wZXJhdHVyZSddXG4gICAgKTtcbiAgICBleHBlY3QodHlwZUNhc2UuZXhoYXVzdGl2ZVZhcmlhbnRzKS50b0NvbnRhaW5TZWxlY3Rpb25TZXRNYXRjaGluZyhbJ0Zpc2gnXSwgWyduYW1lJ10pO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFsnQ3JvY29kaWxlJ10sIFtdKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3Qga2VlcCB0eXBlIGNvbmRpdGlvbnMgd2hlbiBhbGwgcG9zc2libGUgb2JqZWN0cyBtYXRjaCcsICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gY29tcGlsZShcbiAgICAgIGBcbiAgICAgIHF1ZXJ5IEFuaW1hbCB7XG4gICAgICAgIGNhdE9yQmlyZCB7XG4gICAgICAgICAgLi4uIG9uIFBldCB7XG4gICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICAuLi4gb24gV2FybUJsb29kZWQge1xuICAgICAgICAgICAgICBib2R5VGVtcGVyYXR1cmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgLFxuICAgICAgYW5pbWFsU2NoZW1hXG4gICAgKTtcblxuICAgIGNvbnN0IHNlbGVjdGlvblNldCA9IChjb250ZXh0Lm9wZXJhdGlvbnNbJ0FuaW1hbCddLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zWzBdIGFzIEZpZWxkKVxuICAgICAgLnNlbGVjdGlvblNldCBhcyBTZWxlY3Rpb25TZXQ7XG4gICAgY29uc3QgdHlwZUNhc2UgPSB0eXBlQ2FzZUZvclNlbGVjdGlvblNldChzZWxlY3Rpb25TZXQpO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmRlZmF1bHQpLnRvTWF0Y2hTZWxlY3Rpb25TZXQoWydDYXQnLCAnQmlyZCddLCBbJ25hbWUnLCAnYm9keVRlbXBlcmF0dXJlJ10pO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS52YXJpYW50cykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgZXhwZWN0KHR5cGVDYXNlLmV4aGF1c3RpdmVWYXJpYW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh0eXBlQ2FzZS5leGhhdXN0aXZlVmFyaWFudHMpLnRvQ29udGFpblNlbGVjdGlvblNldE1hdGNoaW5nKFxuICAgICAgWydDYXQnLCAnQmlyZCddLFxuICAgICAgWyduYW1lJywgJ2JvZHlUZW1wZXJhdHVyZSddXG4gICAgKTtcbiAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=