3d2d9c27cd2ace5bf6318650eec3ecb5
'use strict';require('ts-jest').install("/c/Users/Sandro/repo/amplify-cli/packages/amplify-graphql-types-generator/src/utilities/graphql.ts", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst graphql_1 = require(\"graphql\");\nfunction sortEnumValues(values) {\n    return values.sort((a, b) => (a.value < b.value ? -1 : a.value > b.value ? 1 : 0));\n}\nexports.sortEnumValues = sortEnumValues;\nfunction isList(type) {\n    return graphql_1.isListType(type) || (graphql_1.isNonNullType(type) && graphql_1.isListType(type.ofType));\n}\nexports.isList = isList;\nfunction isMetaFieldName(name) {\n    return name.startsWith('__');\n}\nexports.isMetaFieldName = isMetaFieldName;\nfunction removeConnectionDirectives(ast) {\n    return graphql_1.visit(ast, {\n        Directive(node) {\n            if (node.name.value === 'connection')\n                return null;\n            return node;\n        }\n    });\n}\nexports.removeConnectionDirectives = removeConnectionDirectives;\nfunction removeClientDirectives(ast) {\n    return graphql_1.visit(ast, {\n        Field(node) {\n            if (node.directives && node.directives.find(directive => directive.name.value === 'client'))\n                return null;\n            return node;\n        },\n        OperationDefinition: {\n            leave(node) {\n                if (!node.selectionSet.selections.length)\n                    return null;\n                return node;\n            }\n        }\n    });\n}\nexports.removeClientDirectives = removeClientDirectives;\nconst typenameField = {\n    kind: graphql_1.Kind.FIELD,\n    name: { kind: graphql_1.Kind.NAME, value: '__typename' }\n};\nfunction withTypenameFieldAddedWhereNeeded(ast) {\n    return graphql_1.visit(ast, {\n        enter: {\n            SelectionSet(node) {\n                return Object.assign({}, node, { selections: node.selections.filter(selection => !(selection.kind === 'Field' && selection.name.value === '__typename')) });\n            }\n        },\n        leave(node) {\n            if (!(node.kind === 'Field' || node.kind === 'FragmentDefinition'))\n                return undefined;\n            if (!node.selectionSet)\n                return undefined;\n            if (true) {\n                return Object.assign({}, node, { selectionSet: Object.assign({}, node.selectionSet, { selections: [typenameField, ...node.selectionSet.selections] }) });\n            }\n            else {\n                return undefined;\n            }\n        }\n    });\n}\nexports.withTypenameFieldAddedWhereNeeded = withTypenameFieldAddedWhereNeeded;\nfunction sourceAt(location) {\n    return location.source.body.slice(location.start, location.end);\n}\nexports.sourceAt = sourceAt;\nfunction filePathForNode(node) {\n    const name = node.loc && node.loc.source && node.loc.source.name;\n    if (!name || name === 'GraphQL') {\n        throw new Error('Node does not seem to have a file path');\n    }\n    return name;\n}\nexports.filePathForNode = filePathForNode;\nfunction valueFromValueNode(valueNode) {\n    switch (valueNode.kind) {\n        case 'IntValue':\n        case 'FloatValue':\n            return Number(valueNode.value);\n        case 'NullValue':\n            return null;\n        case 'ListValue':\n            return valueNode.values.map(valueFromValueNode);\n        case 'ObjectValue':\n            return valueNode.fields.reduce((object, field) => {\n                object[field.name.value] = valueFromValueNode(field.value);\n                return object;\n            }, {});\n        case 'Variable':\n            return { kind: 'Variable', variableName: valueNode.name.value };\n        default:\n            return valueNode.value;\n    }\n}\nexports.valueFromValueNode = valueFromValueNode;\nfunction isTypeProperSuperTypeOf(schema, maybeSuperType, subType) {\n    return (graphql_1.isEqualType(maybeSuperType, subType) ||\n        (subType instanceof graphql_1.GraphQLObjectType &&\n            (graphql_1.isAbstractType(maybeSuperType) && schema.isPossibleType(maybeSuperType, subType))));\n}\nexports.isTypeProperSuperTypeOf = isTypeProperSuperTypeOf;\nfunction getOperationRootType(schema, operation) {\n    switch (operation.operation) {\n        case 'query':\n            return schema.getQueryType();\n        case 'mutation':\n            const mutationType = schema.getMutationType();\n            if (!mutationType) {\n                throw new graphql_1.GraphQLError('Schema is not configured for mutations', [operation]);\n            }\n            return mutationType;\n        case 'subscription':\n            const subscriptionType = schema.getSubscriptionType();\n            if (!subscriptionType) {\n                throw new graphql_1.GraphQLError('Schema is not configured for subscriptions', [operation]);\n            }\n            return subscriptionType;\n        default:\n            throw new graphql_1.GraphQLError('Can only compile queries, mutations and subscriptions', [operation]);\n    }\n}\nexports.getOperationRootType = getOperationRootType;\nfunction getFieldDef(schema, parentType, fieldAST) {\n    const name = fieldAST.name.value;\n    if (name === graphql_1.SchemaMetaFieldDef.name && schema.getQueryType() === parentType) {\n        return graphql_1.SchemaMetaFieldDef;\n    }\n    if (name === graphql_1.TypeMetaFieldDef.name && schema.getQueryType() === parentType) {\n        return graphql_1.TypeMetaFieldDef;\n    }\n    if (name === graphql_1.TypeNameMetaFieldDef.name &&\n        (parentType instanceof graphql_1.GraphQLObjectType ||\n            parentType instanceof graphql_1.GraphQLInterfaceType ||\n            parentType instanceof graphql_1.GraphQLUnionType)) {\n        return graphql_1.TypeNameMetaFieldDef;\n    }\n    if (parentType instanceof graphql_1.GraphQLObjectType || parentType instanceof graphql_1.GraphQLInterfaceType) {\n        return parentType.getFields()[name];\n    }\n    return undefined;\n}\nexports.getFieldDef = getFieldDef;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JhcGhxbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdyYXBocWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxxQ0EyQmlCO0FBU2pCLHdCQUErQixNQUEwQjtJQUN2RCxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3JGLENBQUM7QUFGRCx3Q0FFQztBQUVELGdCQUF1QixJQUFpQjtJQUN0QyxPQUFPLG9CQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyx1QkFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLG9CQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDOUUsQ0FBQztBQUZELHdCQUVDO0FBRUQseUJBQWdDLElBQVk7SUFDMUMsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9CLENBQUM7QUFGRCwwQ0FFQztBQUVELG9DQUEyQyxHQUFZO0lBQ3JELE9BQU8sZUFBSyxDQUFDLEdBQUcsRUFBRTtRQUNoQixTQUFTLENBQUMsSUFBbUI7WUFDM0IsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxZQUFZO2dCQUFFLE9BQU8sSUFBSSxDQUFDO1lBQ2xELE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztLQUNGLENBQUMsQ0FBQztBQUNMLENBQUM7QUFQRCxnRUFPQztBQUVELGdDQUF1QyxHQUFZO0lBQ2pELE9BQU8sZUFBSyxDQUFDLEdBQUcsRUFBRTtRQUNoQixLQUFLLENBQUMsSUFBZTtZQUNuQixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxRQUFRLENBQUM7Z0JBQ3pGLE9BQU8sSUFBSSxDQUFDO1lBQ2QsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBQ0QsbUJBQW1CLEVBQUU7WUFDbkIsS0FBSyxDQUFDLElBQTZCO2dCQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsTUFBTTtvQkFBRSxPQUFPLElBQUksQ0FBQztnQkFDdEQsT0FBTyxJQUFJLENBQUM7WUFDZCxDQUFDO1NBQ0Y7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDO0FBZEQsd0RBY0M7QUFFRCxNQUFNLGFBQWEsR0FBRztJQUNwQixJQUFJLEVBQUUsY0FBSSxDQUFDLEtBQUs7SUFDaEIsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLGNBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRTtDQUMvQyxDQUFDO0FBRUYsMkNBQWtELEdBQVk7SUFDNUQsT0FBTyxlQUFLLENBQUMsR0FBRyxFQUFFO1FBQ2hCLEtBQUssRUFBRTtZQUNMLFlBQVksQ0FBQyxJQUFzQjtnQkFDakMseUJBQ0ssSUFBSSxJQUNQLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FDaEMsU0FBUyxDQUFDLEVBQUUsQ0FDVixDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksS0FBSyxPQUFPLElBQUssU0FBdUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxLQUFLLFlBQVksQ0FBQyxDQUN4RixJQUNEO1lBQ0osQ0FBQztTQUNGO1FBQ0QsS0FBSyxDQUFDLElBQWE7WUFDakIsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxvQkFBb0IsQ0FBQztnQkFBRSxPQUFPLFNBQVMsQ0FBQztZQUNyRixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVk7Z0JBQUUsT0FBTyxTQUFTLENBQUM7WUFFekMsSUFBSSxJQUFJLEVBQUU7Z0JBQ1IseUJBQ0ssSUFBSSxJQUNQLFlBQVksb0JBQ1AsSUFBSSxDQUFDLFlBQVksSUFDcEIsVUFBVSxFQUFFLENBQUMsYUFBYSxFQUFFLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsT0FFOUQ7YUFDSDtpQkFBTTtnQkFDTCxPQUFPLFNBQVMsQ0FBQzthQUNsQjtRQUNILENBQUM7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDO0FBOUJELDhFQThCQztBQUVELGtCQUF5QixRQUFrQjtJQUN6QyxPQUFPLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNsRSxDQUFDO0FBRkQsNEJBRUM7QUFFRCx5QkFBZ0MsSUFBYTtJQUMzQyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQztJQUNqRSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7UUFDL0IsTUFBTSxJQUFJLEtBQUssQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO0tBQzNEO0lBQ0QsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBTkQsMENBTUM7QUFFRCw0QkFDRSxTQUFvQjtJQUVwQixRQUFRLFNBQVMsQ0FBQyxJQUFJLEVBQUU7UUFDdEIsS0FBSyxVQUFVLENBQUM7UUFDaEIsS0FBSyxZQUFZO1lBQ2YsT0FBTyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pDLEtBQUssV0FBVztZQUNkLE9BQU8sSUFBSSxDQUFDO1FBQ2QsS0FBSyxXQUFXO1lBQ2QsT0FBTyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2xELEtBQUssYUFBYTtZQUNoQixPQUFPLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUM1QixDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBRTtnQkFDaEIsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMzRCxPQUFPLE1BQU0sQ0FBQztZQUNoQixDQUFDLEVBQ0QsRUFBUyxDQUNWLENBQUM7UUFDSixLQUFLLFVBQVU7WUFDYixPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNsRTtZQUNFLE9BQU8sU0FBUyxDQUFDLEtBQUssQ0FBQztLQUMxQjtBQUNILENBQUM7QUF4QkQsZ0RBd0JDO0FBRUQsaUNBQ0UsTUFBcUIsRUFDckIsY0FBb0MsRUFDcEMsT0FBNkI7SUFFN0IsT0FBTyxDQUNMLHFCQUFXLENBQUMsY0FBYyxFQUFFLE9BQU8sQ0FBQztRQUNwQyxDQUFDLE9BQU8sWUFBWSwyQkFBaUI7WUFDbkMsQ0FBQyx3QkFBYyxDQUFDLGNBQWMsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxjQUFjLENBQUMsY0FBYyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FDdEYsQ0FBQztBQUNKLENBQUM7QUFWRCwwREFVQztBQU9ELDhCQUFxQyxNQUFxQixFQUFFLFNBQWtDO0lBQzVGLFFBQVEsU0FBUyxDQUFDLFNBQVMsRUFBRTtRQUMzQixLQUFLLE9BQU87WUFDVixPQUFPLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUMvQixLQUFLLFVBQVU7WUFDYixNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDOUMsSUFBSSxDQUFDLFlBQVksRUFBRTtnQkFDakIsTUFBTSxJQUFJLHNCQUFZLENBQUMsd0NBQXdDLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2FBQy9FO1lBQ0QsT0FBTyxZQUFZLENBQUM7UUFDdEIsS0FBSyxjQUFjO1lBQ2pCLE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxDQUFDLG1CQUFtQixFQUFFLENBQUM7WUFDdEQsSUFBSSxDQUFDLGdCQUFnQixFQUFFO2dCQUNyQixNQUFNLElBQUksc0JBQVksQ0FBQyw0Q0FBNEMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7YUFDbkY7WUFDRCxPQUFPLGdCQUFnQixDQUFDO1FBQzFCO1lBQ0UsTUFBTSxJQUFJLHNCQUFZLENBQUMsdURBQXVELEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0tBQ2hHO0FBQ0gsQ0FBQztBQW5CRCxvREFtQkM7QUFPRCxxQkFDRSxNQUFxQixFQUNyQixVQUFnQyxFQUNoQyxRQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztJQUNqQyxJQUFJLElBQUksS0FBSyw0QkFBa0IsQ0FBQyxJQUFJLElBQUksTUFBTSxDQUFDLFlBQVksRUFBRSxLQUFLLFVBQVUsRUFBRTtRQUM1RSxPQUFPLDRCQUFrQixDQUFDO0tBQzNCO0lBQ0QsSUFBSSxJQUFJLEtBQUssMEJBQWdCLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxZQUFZLEVBQUUsS0FBSyxVQUFVLEVBQUU7UUFDMUUsT0FBTywwQkFBZ0IsQ0FBQztLQUN6QjtJQUNELElBQ0UsSUFBSSxLQUFLLDhCQUFvQixDQUFDLElBQUk7UUFDbEMsQ0FBQyxVQUFVLFlBQVksMkJBQWlCO1lBQ3RDLFVBQVUsWUFBWSw4QkFBb0I7WUFDMUMsVUFBVSxZQUFZLDBCQUFnQixDQUFDLEVBQ3pDO1FBQ0EsT0FBTyw4QkFBb0IsQ0FBQztLQUM3QjtJQUNELElBQUksVUFBVSxZQUFZLDJCQUFpQixJQUFJLFVBQVUsWUFBWSw4QkFBb0IsRUFBRTtRQUN6RixPQUFPLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNyQztJQUVELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUM7QUF6QkQsa0NBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgdmlzaXQsXG4gIEtpbmQsXG4gIGlzRXF1YWxUeXBlLFxuICBpc0Fic3RyYWN0VHlwZSxcbiAgU2NoZW1hTWV0YUZpZWxkRGVmLFxuICBUeXBlTWV0YUZpZWxkRGVmLFxuICBUeXBlTmFtZU1ldGFGaWVsZERlZixcbiAgR3JhcGhRTENvbXBvc2l0ZVR5cGUsXG4gIEdyYXBoUUxPYmplY3RUeXBlLFxuICBHcmFwaFFMSW50ZXJmYWNlVHlwZSxcbiAgR3JhcGhRTFVuaW9uVHlwZSxcbiAgR3JhcGhRTEVudW1WYWx1ZSxcbiAgR3JhcGhRTEVycm9yLFxuICBHcmFwaFFMU2NoZW1hLFxuICBHcmFwaFFMVHlwZSxcbiAgQVNUTm9kZSxcbiAgTG9jYXRpb24sXG4gIFZhbHVlTm9kZSxcbiAgT3BlcmF0aW9uRGVmaW5pdGlvbk5vZGUsXG4gIFNlbGVjdGlvblNldE5vZGUsXG4gIEZpZWxkTm9kZSxcbiAgR3JhcGhRTEZpZWxkLFxuICBEb2N1bWVudE5vZGUsXG4gIERpcmVjdGl2ZU5vZGUsXG4gIGlzTGlzdFR5cGUsXG4gIGlzTm9uTnVsbFR5cGVcbn0gZnJvbSAnZ3JhcGhxbCc7XG5cbmRlY2xhcmUgbW9kdWxlICdncmFwaHFsL3V0aWxpdGllcy9idWlsZEFTVFNjaGVtYScge1xuICBmdW5jdGlvbiBidWlsZEFTVFNjaGVtYShcbiAgICBhc3Q6IERvY3VtZW50Tm9kZSxcbiAgICBvcHRpb25zPzogeyBhc3N1bWVWYWxpZD86IGJvb2xlYW47IGNvbW1lbnREZXNjcmlwdGlvbnM/OiBib29sZWFuIH1cbiAgKTogR3JhcGhRTFNjaGVtYTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRFbnVtVmFsdWVzKHZhbHVlczogR3JhcGhRTEVudW1WYWx1ZVtdKTogR3JhcGhRTEVudW1WYWx1ZVtdIHtcbiAgcmV0dXJuIHZhbHVlcy5zb3J0KChhLCBiKSA9PiAoYS52YWx1ZSA8IGIudmFsdWUgPyAtMSA6IGEudmFsdWUgPiBiLnZhbHVlID8gMSA6IDApKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTGlzdCh0eXBlOiBHcmFwaFFMVHlwZSk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXNMaXN0VHlwZSh0eXBlKSB8fCAoaXNOb25OdWxsVHlwZSh0eXBlKSAmJiBpc0xpc3RUeXBlKHR5cGUub2ZUeXBlKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01ldGFGaWVsZE5hbWUobmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBuYW1lLnN0YXJ0c1dpdGgoJ19fJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDb25uZWN0aW9uRGlyZWN0aXZlcyhhc3Q6IEFTVE5vZGUpIHtcbiAgcmV0dXJuIHZpc2l0KGFzdCwge1xuICAgIERpcmVjdGl2ZShub2RlOiBEaXJlY3RpdmVOb2RlKTogRGlyZWN0aXZlTm9kZSB8IG51bGwge1xuICAgICAgaWYgKG5vZGUubmFtZS52YWx1ZSA9PT0gJ2Nvbm5lY3Rpb24nKSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDbGllbnREaXJlY3RpdmVzKGFzdDogQVNUTm9kZSkge1xuICByZXR1cm4gdmlzaXQoYXN0LCB7XG4gICAgRmllbGQobm9kZTogRmllbGROb2RlKTogRmllbGROb2RlIHwgbnVsbCB7XG4gICAgICBpZiAobm9kZS5kaXJlY3RpdmVzICYmIG5vZGUuZGlyZWN0aXZlcy5maW5kKGRpcmVjdGl2ZSA9PiBkaXJlY3RpdmUubmFtZS52YWx1ZSA9PT0gJ2NsaWVudCcpKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG4gICAgT3BlcmF0aW9uRGVmaW5pdGlvbjoge1xuICAgICAgbGVhdmUobm9kZTogT3BlcmF0aW9uRGVmaW5pdGlvbk5vZGUpOiBPcGVyYXRpb25EZWZpbml0aW9uTm9kZSB8IG51bGwge1xuICAgICAgICBpZiAoIW5vZGUuc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuY29uc3QgdHlwZW5hbWVGaWVsZCA9IHtcbiAga2luZDogS2luZC5GSUVMRCxcbiAgbmFtZTogeyBraW5kOiBLaW5kLk5BTUUsIHZhbHVlOiAnX190eXBlbmFtZScgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUeXBlbmFtZUZpZWxkQWRkZWRXaGVyZU5lZWRlZChhc3Q6IEFTVE5vZGUpIHtcbiAgcmV0dXJuIHZpc2l0KGFzdCwge1xuICAgIGVudGVyOiB7XG4gICAgICBTZWxlY3Rpb25TZXQobm9kZTogU2VsZWN0aW9uU2V0Tm9kZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm5vZGUsXG4gICAgICAgICAgc2VsZWN0aW9uczogbm9kZS5zZWxlY3Rpb25zLmZpbHRlcihcbiAgICAgICAgICAgIHNlbGVjdGlvbiA9PlxuICAgICAgICAgICAgICAhKHNlbGVjdGlvbi5raW5kID09PSAnRmllbGQnICYmIChzZWxlY3Rpb24gYXMgRmllbGROb2RlKS5uYW1lLnZhbHVlID09PSAnX190eXBlbmFtZScpXG4gICAgICAgICAgKVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgbGVhdmUobm9kZTogQVNUTm9kZSkge1xuICAgICAgaWYgKCEobm9kZS5raW5kID09PSAnRmllbGQnIHx8IG5vZGUua2luZCA9PT0gJ0ZyYWdtZW50RGVmaW5pdGlvbicpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgaWYgKCFub2RlLnNlbGVjdGlvblNldCkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHRydWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5ub2RlLFxuICAgICAgICAgIHNlbGVjdGlvblNldDoge1xuICAgICAgICAgICAgLi4ubm9kZS5zZWxlY3Rpb25TZXQsXG4gICAgICAgICAgICBzZWxlY3Rpb25zOiBbdHlwZW5hbWVGaWVsZCwgLi4ubm9kZS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc11cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3VyY2VBdChsb2NhdGlvbjogTG9jYXRpb24pIHtcbiAgcmV0dXJuIGxvY2F0aW9uLnNvdXJjZS5ib2R5LnNsaWNlKGxvY2F0aW9uLnN0YXJ0LCBsb2NhdGlvbi5lbmQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZVBhdGhGb3JOb2RlKG5vZGU6IEFTVE5vZGUpOiBzdHJpbmcge1xuICBjb25zdCBuYW1lID0gbm9kZS5sb2MgJiYgbm9kZS5sb2Muc291cmNlICYmIG5vZGUubG9jLnNvdXJjZS5uYW1lO1xuICBpZiAoIW5hbWUgfHwgbmFtZSA9PT0gJ0dyYXBoUUwnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdOb2RlIGRvZXMgbm90IHNlZW0gdG8gaGF2ZSBhIGZpbGUgcGF0aCcpO1xuICB9XG4gIHJldHVybiBuYW1lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVGcm9tVmFsdWVOb2RlKFxuICB2YWx1ZU5vZGU6IFZhbHVlTm9kZVxuKTogYW55IHwgeyBraW5kOiAnVmFyaWFibGUnOyB2YXJpYWJsZU5hbWU6IHN0cmluZyB9IHtcbiAgc3dpdGNoICh2YWx1ZU5vZGUua2luZCkge1xuICAgIGNhc2UgJ0ludFZhbHVlJzpcbiAgICBjYXNlICdGbG9hdFZhbHVlJzpcbiAgICAgIHJldHVybiBOdW1iZXIodmFsdWVOb2RlLnZhbHVlKTtcbiAgICBjYXNlICdOdWxsVmFsdWUnOlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgY2FzZSAnTGlzdFZhbHVlJzpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUudmFsdWVzLm1hcCh2YWx1ZUZyb21WYWx1ZU5vZGUpO1xuICAgIGNhc2UgJ09iamVjdFZhbHVlJzpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUuZmllbGRzLnJlZHVjZShcbiAgICAgICAgKG9iamVjdCwgZmllbGQpID0+IHtcbiAgICAgICAgICBvYmplY3RbZmllbGQubmFtZS52YWx1ZV0gPSB2YWx1ZUZyb21WYWx1ZU5vZGUoZmllbGQudmFsdWUpO1xuICAgICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICAgIH0sXG4gICAgICAgIHt9IGFzIGFueVxuICAgICAgKTtcbiAgICBjYXNlICdWYXJpYWJsZSc6XG4gICAgICByZXR1cm4geyBraW5kOiAnVmFyaWFibGUnLCB2YXJpYWJsZU5hbWU6IHZhbHVlTm9kZS5uYW1lLnZhbHVlIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUudmFsdWU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVHlwZVByb3BlclN1cGVyVHlwZU9mKFxuICBzY2hlbWE6IEdyYXBoUUxTY2hlbWEsXG4gIG1heWJlU3VwZXJUeXBlOiBHcmFwaFFMQ29tcG9zaXRlVHlwZSxcbiAgc3ViVHlwZTogR3JhcGhRTENvbXBvc2l0ZVR5cGVcbikge1xuICByZXR1cm4gKFxuICAgIGlzRXF1YWxUeXBlKG1heWJlU3VwZXJUeXBlLCBzdWJUeXBlKSB8fFxuICAgIChzdWJUeXBlIGluc3RhbmNlb2YgR3JhcGhRTE9iamVjdFR5cGUgJiZcbiAgICAgIChpc0Fic3RyYWN0VHlwZShtYXliZVN1cGVyVHlwZSkgJiYgc2NoZW1hLmlzUG9zc2libGVUeXBlKG1heWJlU3VwZXJUeXBlLCBzdWJUeXBlKSkpXG4gICk7XG59XG5cbi8vIFV0aWxpdHkgZnVuY3Rpb25zIGV4dHJhY3RlZCBmcm9tIGdyYXBocWwtanNcblxuLyoqXG4gKiBFeHRyYWN0cyB0aGUgcm9vdCB0eXBlIG9mIHRoZSBvcGVyYXRpb24gZnJvbSB0aGUgc2NoZW1hLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3BlcmF0aW9uUm9vdFR5cGUoc2NoZW1hOiBHcmFwaFFMU2NoZW1hLCBvcGVyYXRpb246IE9wZXJhdGlvbkRlZmluaXRpb25Ob2RlKSB7XG4gIHN3aXRjaCAob3BlcmF0aW9uLm9wZXJhdGlvbikge1xuICAgIGNhc2UgJ3F1ZXJ5JzpcbiAgICAgIHJldHVybiBzY2hlbWEuZ2V0UXVlcnlUeXBlKCk7XG4gICAgY2FzZSAnbXV0YXRpb24nOlxuICAgICAgY29uc3QgbXV0YXRpb25UeXBlID0gc2NoZW1hLmdldE11dGF0aW9uVHlwZSgpO1xuICAgICAgaWYgKCFtdXRhdGlvblR5cGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignU2NoZW1hIGlzIG5vdCBjb25maWd1cmVkIGZvciBtdXRhdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbXV0YXRpb25UeXBlO1xuICAgIGNhc2UgJ3N1YnNjcmlwdGlvbic6XG4gICAgICBjb25zdCBzdWJzY3JpcHRpb25UeXBlID0gc2NoZW1hLmdldFN1YnNjcmlwdGlvblR5cGUoKTtcbiAgICAgIGlmICghc3Vic2NyaXB0aW9uVHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdTY2hlbWEgaXMgbm90IGNvbmZpZ3VyZWQgZm9yIHN1YnNjcmlwdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uVHlwZTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignQ2FuIG9ubHkgY29tcGlsZSBxdWVyaWVzLCBtdXRhdGlvbnMgYW5kIHN1YnNjcmlwdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gIH1cbn1cblxuLyoqXG4gKiBOb3QgZXhhY3RseSB0aGUgc2FtZSBhcyB0aGUgZXhlY3V0b3IncyBkZWZpbml0aW9uIG9mIGdldEZpZWxkRGVmLCBpbiB0aGlzXG4gKiBzdGF0aWNhbGx5IGV2YWx1YXRlZCBlbnZpcm9ubWVudCB3ZSBkbyBub3QgYWx3YXlzIGhhdmUgYW4gT2JqZWN0IHR5cGUsXG4gKiBhbmQgbmVlZCB0byBoYW5kbGUgSW50ZXJmYWNlIGFuZCBVbmlvbiB0eXBlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZpZWxkRGVmKFxuICBzY2hlbWE6IEdyYXBoUUxTY2hlbWEsXG4gIHBhcmVudFR5cGU6IEdyYXBoUUxDb21wb3NpdGVUeXBlLFxuICBmaWVsZEFTVDogRmllbGROb2RlXG4pOiBHcmFwaFFMRmllbGQ8YW55LCBhbnk+IHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgbmFtZSA9IGZpZWxkQVNULm5hbWUudmFsdWU7XG4gIGlmIChuYW1lID09PSBTY2hlbWFNZXRhRmllbGREZWYubmFtZSAmJiBzY2hlbWEuZ2V0UXVlcnlUeXBlKCkgPT09IHBhcmVudFR5cGUpIHtcbiAgICByZXR1cm4gU2NoZW1hTWV0YUZpZWxkRGVmO1xuICB9XG4gIGlmIChuYW1lID09PSBUeXBlTWV0YUZpZWxkRGVmLm5hbWUgJiYgc2NoZW1hLmdldFF1ZXJ5VHlwZSgpID09PSBwYXJlbnRUeXBlKSB7XG4gICAgcmV0dXJuIFR5cGVNZXRhRmllbGREZWY7XG4gIH1cbiAgaWYgKFxuICAgIG5hbWUgPT09IFR5cGVOYW1lTWV0YUZpZWxkRGVmLm5hbWUgJiZcbiAgICAocGFyZW50VHlwZSBpbnN0YW5jZW9mIEdyYXBoUUxPYmplY3RUeXBlIHx8XG4gICAgICBwYXJlbnRUeXBlIGluc3RhbmNlb2YgR3JhcGhRTEludGVyZmFjZVR5cGUgfHxcbiAgICAgIHBhcmVudFR5cGUgaW5zdGFuY2VvZiBHcmFwaFFMVW5pb25UeXBlKVxuICApIHtcbiAgICByZXR1cm4gVHlwZU5hbWVNZXRhRmllbGREZWY7XG4gIH1cbiAgaWYgKHBhcmVudFR5cGUgaW5zdGFuY2VvZiBHcmFwaFFMT2JqZWN0VHlwZSB8fCBwYXJlbnRUeXBlIGluc3RhbmNlb2YgR3JhcGhRTEludGVyZmFjZVR5cGUpIHtcbiAgICByZXR1cm4gcGFyZW50VHlwZS5nZXRGaWVsZHMoKVtuYW1lXTtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG4iXX0=");"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const graphql_1 = require("graphql");
function sortEnumValues(values) {
    return values.sort((a, b) => a.value < b.value ? -1 : a.value > b.value ? 1 : 0);
}
exports.sortEnumValues = sortEnumValues;
function isList(type) {
    return graphql_1.isListType(type) || graphql_1.isNonNullType(type) && graphql_1.isListType(type.ofType);
}
exports.isList = isList;
function isMetaFieldName(name) {
    return name.startsWith('__');
}
exports.isMetaFieldName = isMetaFieldName;
function removeConnectionDirectives(ast) {
    return graphql_1.visit(ast, {
        Directive(node) {
            if (node.name.value === 'connection')
            return null;
            return node;
        } });

}
exports.removeConnectionDirectives = removeConnectionDirectives;
function removeClientDirectives(ast) {
    return graphql_1.visit(ast, {
        Field(node) {
            if (node.directives && node.directives.find(directive => directive.name.value === 'client'))
            return null;
            return node;
        },
        OperationDefinition: {
            leave(node) {
                if (!node.selectionSet.selections.length)
                return null;
                return node;
            } } });


}
exports.removeClientDirectives = removeClientDirectives;
const typenameField = {
    kind: graphql_1.Kind.FIELD,
    name: { kind: graphql_1.Kind.NAME, value: '__typename' } };

function withTypenameFieldAddedWhereNeeded(ast) {
    return graphql_1.visit(ast, {
        enter: {
            SelectionSet(node) {
                return Object.assign({}, node, { selections: node.selections.filter(selection => !(selection.kind === 'Field' && selection.name.value === '__typename')) });
            } },

        leave(node) {
            if (!(node.kind === 'Field' || node.kind === 'FragmentDefinition'))
            return undefined;
            if (!node.selectionSet)
            return undefined;
            if (true) {
                return Object.assign({}, node, { selectionSet: Object.assign({}, node.selectionSet, { selections: [typenameField, ...node.selectionSet.selections] }) });
            } else
            {
                return undefined;
            }
        } });

}
exports.withTypenameFieldAddedWhereNeeded = withTypenameFieldAddedWhereNeeded;
function sourceAt(location) {
    return location.source.body.slice(location.start, location.end);
}
exports.sourceAt = sourceAt;
function filePathForNode(node) {
    const name = node.loc && node.loc.source && node.loc.source.name;
    if (!name || name === 'GraphQL') {
        throw new Error('Node does not seem to have a file path');
    }
    return name;
}
exports.filePathForNode = filePathForNode;
function valueFromValueNode(valueNode) {
    switch (valueNode.kind) {
        case 'IntValue':
        case 'FloatValue':
            return Number(valueNode.value);
        case 'NullValue':
            return null;
        case 'ListValue':
            return valueNode.values.map(valueFromValueNode);
        case 'ObjectValue':
            return valueNode.fields.reduce((object, field) => {
                object[field.name.value] = valueFromValueNode(field.value);
                return object;
            }, {});
        case 'Variable':
            return { kind: 'Variable', variableName: valueNode.name.value };
        default:
            return valueNode.value;}

}
exports.valueFromValueNode = valueFromValueNode;
function isTypeProperSuperTypeOf(schema, maybeSuperType, subType) {
    return graphql_1.isEqualType(maybeSuperType, subType) ||
    subType instanceof graphql_1.GraphQLObjectType &&
    graphql_1.isAbstractType(maybeSuperType) && schema.isPossibleType(maybeSuperType, subType);
}
exports.isTypeProperSuperTypeOf = isTypeProperSuperTypeOf;
function getOperationRootType(schema, operation) {
    switch (operation.operation) {
        case 'query':
            return schema.getQueryType();
        case 'mutation':
            const mutationType = schema.getMutationType();
            if (!mutationType) {
                throw new graphql_1.GraphQLError('Schema is not configured for mutations', [operation]);
            }
            return mutationType;
        case 'subscription':
            const subscriptionType = schema.getSubscriptionType();
            if (!subscriptionType) {
                throw new graphql_1.GraphQLError('Schema is not configured for subscriptions', [operation]);
            }
            return subscriptionType;
        default:
            throw new graphql_1.GraphQLError('Can only compile queries, mutations and subscriptions', [operation]);}

}
exports.getOperationRootType = getOperationRootType;
function getFieldDef(schema, parentType, fieldAST) {
    const name = fieldAST.name.value;
    if (name === graphql_1.SchemaMetaFieldDef.name && schema.getQueryType() === parentType) {
        return graphql_1.SchemaMetaFieldDef;
    }
    if (name === graphql_1.TypeMetaFieldDef.name && schema.getQueryType() === parentType) {
        return graphql_1.TypeMetaFieldDef;
    }
    if (name === graphql_1.TypeNameMetaFieldDef.name && (
    parentType instanceof graphql_1.GraphQLObjectType ||
    parentType instanceof graphql_1.GraphQLInterfaceType ||
    parentType instanceof graphql_1.GraphQLUnionType)) {
        return graphql_1.TypeNameMetaFieldDef;
    }
    if (parentType instanceof graphql_1.GraphQLObjectType || parentType instanceof graphql_1.GraphQLInterfaceType) {
        return parentType.getFields()[name];
    }
    return undefined;
}
exports.getFieldDef = getFieldDef;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxZQUFKLENBQWlCLDRDQUFqQixFQUErRCxDQUFDLFNBQUQsQ0FBL0QsQ0FBTjtBQUNEO0FBQ0QsbUJBQU8sZ0JBQVA7QUFDRjtBQUNFLGtCQUFNLElBQUksVUFBQSxZQUFKLENBQWlCLHVEQUFqQixFQUEwRSxDQUFDLFNBQUQsQ0FBMUUsQ0FBTixDQWhCSjs7QUFrQkQ7QUFuQkQsUUFBQSxvQkFBQSxHQUFBLG9CQUFBO0FBMEJBLFNBQUEsV0FBQSxDQUNFLE1BREYsRUFFRSxVQUZGLEVBR0UsUUFIRixFQUdxQjtBQUVuQixVQUFNLE9BQU8sU0FBUyxJQUFULENBQWMsS0FBM0I7QUFDQSxRQUFJLFNBQVMsVUFBQSxrQkFBQSxDQUFtQixJQUE1QixJQUFvQyxPQUFPLFlBQVAsT0FBMEIsVUFBbEUsRUFBOEU7QUFDNUUsZUFBTyxVQUFBLGtCQUFQO0FBQ0Q7QUFDRCxRQUFJLFNBQVMsVUFBQSxnQkFBQSxDQUFpQixJQUExQixJQUFrQyxPQUFPLFlBQVAsT0FBMEIsVUFBaEUsRUFBNEU7QUFDMUUsZUFBTyxVQUFBLGdCQUFQO0FBQ0Q7QUFDRCxRQUNFLFNBQVMsVUFBQSxvQkFBQSxDQUFxQixJQUE5QjtBQUNDLDBCQUFzQixVQUFBLGlCQUF0QjtBQUNDLDBCQUFzQixVQUFBLG9CQUR2QjtBQUVDLDBCQUFzQixVQUFBLGdCQUh4QixDQURGLEVBS0U7QUFDQSxlQUFPLFVBQUEsb0JBQVA7QUFDRDtBQUNELFFBQUksc0JBQXNCLFVBQUEsaUJBQXRCLElBQTJDLHNCQUFzQixVQUFBLG9CQUFyRSxFQUEyRjtBQUN6RixlQUFPLFdBQVcsU0FBWCxHQUF1QixJQUF2QixDQUFQO0FBQ0Q7QUFFRCxXQUFPLFNBQVA7QUFDRDtBQXpCRCxRQUFBLFdBQUEsR0FBQSxXQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgdmlzaXQsXG4gIEtpbmQsXG4gIGlzRXF1YWxUeXBlLFxuICBpc0Fic3RyYWN0VHlwZSxcbiAgU2NoZW1hTWV0YUZpZWxkRGVmLFxuICBUeXBlTWV0YUZpZWxkRGVmLFxuICBUeXBlTmFtZU1ldGFGaWVsZERlZixcbiAgR3JhcGhRTENvbXBvc2l0ZVR5cGUsXG4gIEdyYXBoUUxPYmplY3RUeXBlLFxuICBHcmFwaFFMSW50ZXJmYWNlVHlwZSxcbiAgR3JhcGhRTFVuaW9uVHlwZSxcbiAgR3JhcGhRTEVudW1WYWx1ZSxcbiAgR3JhcGhRTEVycm9yLFxuICBHcmFwaFFMU2NoZW1hLFxuICBHcmFwaFFMVHlwZSxcbiAgQVNUTm9kZSxcbiAgTG9jYXRpb24sXG4gIFZhbHVlTm9kZSxcbiAgT3BlcmF0aW9uRGVmaW5pdGlvbk5vZGUsXG4gIFNlbGVjdGlvblNldE5vZGUsXG4gIEZpZWxkTm9kZSxcbiAgR3JhcGhRTEZpZWxkLFxuICBEb2N1bWVudE5vZGUsXG4gIERpcmVjdGl2ZU5vZGUsXG4gIGlzTGlzdFR5cGUsXG4gIGlzTm9uTnVsbFR5cGVcbn0gZnJvbSAnZ3JhcGhxbCc7XG5cbmRlY2xhcmUgbW9kdWxlICdncmFwaHFsL3V0aWxpdGllcy9idWlsZEFTVFNjaGVtYScge1xuICBmdW5jdGlvbiBidWlsZEFTVFNjaGVtYShcbiAgICBhc3Q6IERvY3VtZW50Tm9kZSxcbiAgICBvcHRpb25zPzogeyBhc3N1bWVWYWxpZD86IGJvb2xlYW47IGNvbW1lbnREZXNjcmlwdGlvbnM/OiBib29sZWFuIH1cbiAgKTogR3JhcGhRTFNjaGVtYTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRFbnVtVmFsdWVzKHZhbHVlczogR3JhcGhRTEVudW1WYWx1ZVtdKTogR3JhcGhRTEVudW1WYWx1ZVtdIHtcbiAgcmV0dXJuIHZhbHVlcy5zb3J0KChhLCBiKSA9PiAoYS52YWx1ZSA8IGIudmFsdWUgPyAtMSA6IGEudmFsdWUgPiBiLnZhbHVlID8gMSA6IDApKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTGlzdCh0eXBlOiBHcmFwaFFMVHlwZSk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXNMaXN0VHlwZSh0eXBlKSB8fCAoaXNOb25OdWxsVHlwZSh0eXBlKSAmJiBpc0xpc3RUeXBlKHR5cGUub2ZUeXBlKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01ldGFGaWVsZE5hbWUobmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBuYW1lLnN0YXJ0c1dpdGgoJ19fJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDb25uZWN0aW9uRGlyZWN0aXZlcyhhc3Q6IEFTVE5vZGUpIHtcbiAgcmV0dXJuIHZpc2l0KGFzdCwge1xuICAgIERpcmVjdGl2ZShub2RlOiBEaXJlY3RpdmVOb2RlKTogRGlyZWN0aXZlTm9kZSB8IG51bGwge1xuICAgICAgaWYgKG5vZGUubmFtZS52YWx1ZSA9PT0gJ2Nvbm5lY3Rpb24nKSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDbGllbnREaXJlY3RpdmVzKGFzdDogQVNUTm9kZSkge1xuICByZXR1cm4gdmlzaXQoYXN0LCB7XG4gICAgRmllbGQobm9kZTogRmllbGROb2RlKTogRmllbGROb2RlIHwgbnVsbCB7XG4gICAgICBpZiAobm9kZS5kaXJlY3RpdmVzICYmIG5vZGUuZGlyZWN0aXZlcy5maW5kKGRpcmVjdGl2ZSA9PiBkaXJlY3RpdmUubmFtZS52YWx1ZSA9PT0gJ2NsaWVudCcpKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG4gICAgT3BlcmF0aW9uRGVmaW5pdGlvbjoge1xuICAgICAgbGVhdmUobm9kZTogT3BlcmF0aW9uRGVmaW5pdGlvbk5vZGUpOiBPcGVyYXRpb25EZWZpbml0aW9uTm9kZSB8IG51bGwge1xuICAgICAgICBpZiAoIW5vZGUuc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuY29uc3QgdHlwZW5hbWVGaWVsZCA9IHtcbiAga2luZDogS2luZC5GSUVMRCxcbiAgbmFtZTogeyBraW5kOiBLaW5kLk5BTUUsIHZhbHVlOiAnX190eXBlbmFtZScgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUeXBlbmFtZUZpZWxkQWRkZWRXaGVyZU5lZWRlZChhc3Q6IEFTVE5vZGUpIHtcbiAgcmV0dXJuIHZpc2l0KGFzdCwge1xuICAgIGVudGVyOiB7XG4gICAgICBTZWxlY3Rpb25TZXQobm9kZTogU2VsZWN0aW9uU2V0Tm9kZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm5vZGUsXG4gICAgICAgICAgc2VsZWN0aW9uczogbm9kZS5zZWxlY3Rpb25zLmZpbHRlcihcbiAgICAgICAgICAgIHNlbGVjdGlvbiA9PlxuICAgICAgICAgICAgICAhKHNlbGVjdGlvbi5raW5kID09PSAnRmllbGQnICYmIChzZWxlY3Rpb24gYXMgRmllbGROb2RlKS5uYW1lLnZhbHVlID09PSAnX190eXBlbmFtZScpXG4gICAgICAgICAgKVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgbGVhdmUobm9kZTogQVNUTm9kZSkge1xuICAgICAgaWYgKCEobm9kZS5raW5kID09PSAnRmllbGQnIHx8IG5vZGUua2luZCA9PT0gJ0ZyYWdtZW50RGVmaW5pdGlvbicpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgaWYgKCFub2RlLnNlbGVjdGlvblNldCkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHRydWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5ub2RlLFxuICAgICAgICAgIHNlbGVjdGlvblNldDoge1xuICAgICAgICAgICAgLi4ubm9kZS5zZWxlY3Rpb25TZXQsXG4gICAgICAgICAgICBzZWxlY3Rpb25zOiBbdHlwZW5hbWVGaWVsZCwgLi4ubm9kZS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc11cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3VyY2VBdChsb2NhdGlvbjogTG9jYXRpb24pIHtcbiAgcmV0dXJuIGxvY2F0aW9uLnNvdXJjZS5ib2R5LnNsaWNlKGxvY2F0aW9uLnN0YXJ0LCBsb2NhdGlvbi5lbmQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZVBhdGhGb3JOb2RlKG5vZGU6IEFTVE5vZGUpOiBzdHJpbmcge1xuICBjb25zdCBuYW1lID0gbm9kZS5sb2MgJiYgbm9kZS5sb2Muc291cmNlICYmIG5vZGUubG9jLnNvdXJjZS5uYW1lO1xuICBpZiAoIW5hbWUgfHwgbmFtZSA9PT0gJ0dyYXBoUUwnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdOb2RlIGRvZXMgbm90IHNlZW0gdG8gaGF2ZSBhIGZpbGUgcGF0aCcpO1xuICB9XG4gIHJldHVybiBuYW1lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVGcm9tVmFsdWVOb2RlKFxuICB2YWx1ZU5vZGU6IFZhbHVlTm9kZVxuKTogYW55IHwgeyBraW5kOiAnVmFyaWFibGUnOyB2YXJpYWJsZU5hbWU6IHN0cmluZyB9IHtcbiAgc3dpdGNoICh2YWx1ZU5vZGUua2luZCkge1xuICAgIGNhc2UgJ0ludFZhbHVlJzpcbiAgICBjYXNlICdGbG9hdFZhbHVlJzpcbiAgICAgIHJldHVybiBOdW1iZXIodmFsdWVOb2RlLnZhbHVlKTtcbiAgICBjYXNlICdOdWxsVmFsdWUnOlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgY2FzZSAnTGlzdFZhbHVlJzpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUudmFsdWVzLm1hcCh2YWx1ZUZyb21WYWx1ZU5vZGUpO1xuICAgIGNhc2UgJ09iamVjdFZhbHVlJzpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUuZmllbGRzLnJlZHVjZShcbiAgICAgICAgKG9iamVjdCwgZmllbGQpID0+IHtcbiAgICAgICAgICBvYmplY3RbZmllbGQubmFtZS52YWx1ZV0gPSB2YWx1ZUZyb21WYWx1ZU5vZGUoZmllbGQudmFsdWUpO1xuICAgICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICAgIH0sXG4gICAgICAgIHt9IGFzIGFueVxuICAgICAgKTtcbiAgICBjYXNlICdWYXJpYWJsZSc6XG4gICAgICByZXR1cm4geyBraW5kOiAnVmFyaWFibGUnLCB2YXJpYWJsZU5hbWU6IHZhbHVlTm9kZS5uYW1lLnZhbHVlIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZU5vZGUudmFsdWU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVHlwZVByb3BlclN1cGVyVHlwZU9mKFxuICBzY2hlbWE6IEdyYXBoUUxTY2hlbWEsXG4gIG1heWJlU3VwZXJUeXBlOiBHcmFwaFFMQ29tcG9zaXRlVHlwZSxcbiAgc3ViVHlwZTogR3JhcGhRTENvbXBvc2l0ZVR5cGVcbikge1xuICByZXR1cm4gKFxuICAgIGlzRXF1YWxUeXBlKG1heWJlU3VwZXJUeXBlLCBzdWJUeXBlKSB8fFxuICAgIChzdWJUeXBlIGluc3RhbmNlb2YgR3JhcGhRTE9iamVjdFR5cGUgJiZcbiAgICAgIChpc0Fic3RyYWN0VHlwZShtYXliZVN1cGVyVHlwZSkgJiYgc2NoZW1hLmlzUG9zc2libGVUeXBlKG1heWJlU3VwZXJUeXBlLCBzdWJUeXBlKSkpXG4gICk7XG59XG5cbi8vIFV0aWxpdHkgZnVuY3Rpb25zIGV4dHJhY3RlZCBmcm9tIGdyYXBocWwtanNcblxuLyoqXG4gKiBFeHRyYWN0cyB0aGUgcm9vdCB0eXBlIG9mIHRoZSBvcGVyYXRpb24gZnJvbSB0aGUgc2NoZW1hLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3BlcmF0aW9uUm9vdFR5cGUoc2NoZW1hOiBHcmFwaFFMU2NoZW1hLCBvcGVyYXRpb246IE9wZXJhdGlvbkRlZmluaXRpb25Ob2RlKSB7XG4gIHN3aXRjaCAob3BlcmF0aW9uLm9wZXJhdGlvbikge1xuICAgIGNhc2UgJ3F1ZXJ5JzpcbiAgICAgIHJldHVybiBzY2hlbWEuZ2V0UXVlcnlUeXBlKCk7XG4gICAgY2FzZSAnbXV0YXRpb24nOlxuICAgICAgY29uc3QgbXV0YXRpb25UeXBlID0gc2NoZW1hLmdldE11dGF0aW9uVHlwZSgpO1xuICAgICAgaWYgKCFtdXRhdGlvblR5cGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignU2NoZW1hIGlzIG5vdCBjb25maWd1cmVkIGZvciBtdXRhdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbXV0YXRpb25UeXBlO1xuICAgIGNhc2UgJ3N1YnNjcmlwdGlvbic6XG4gICAgICBjb25zdCBzdWJzY3JpcHRpb25UeXBlID0gc2NoZW1hLmdldFN1YnNjcmlwdGlvblR5cGUoKTtcbiAgICAgIGlmICghc3Vic2NyaXB0aW9uVHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdTY2hlbWEgaXMgbm90IGNvbmZpZ3VyZWQgZm9yIHN1YnNjcmlwdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uVHlwZTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignQ2FuIG9ubHkgY29tcGlsZSBxdWVyaWVzLCBtdXRhdGlvbnMgYW5kIHN1YnNjcmlwdGlvbnMnLCBbb3BlcmF0aW9uXSk7XG4gIH1cbn1cblxuLyoqXG4gKiBOb3QgZXhhY3RseSB0aGUgc2FtZSBhcyB0aGUgZXhlY3V0b3IncyBkZWZpbml0aW9uIG9mIGdldEZpZWxkRGVmLCBpbiB0aGlzXG4gKiBzdGF0aWNhbGx5IGV2YWx1YXRlZCBlbnZpcm9ubWVudCB3ZSBkbyBub3QgYWx3YXlzIGhhdmUgYW4gT2JqZWN0IHR5cGUsXG4gKiBhbmQgbmVlZCB0byBoYW5kbGUgSW50ZXJmYWNlIGFuZCBVbmlvbiB0eXBlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZpZWxkRGVmKFxuICBzY2hlbWE6IEdyYXBoUUxTY2hlbWEsXG4gIHBhcmVudFR5cGU6IEdyYXBoUUxDb21wb3NpdGVUeXBlLFxuICBmaWVsZEFTVDogRmllbGROb2RlXG4pOiBHcmFwaFFMRmllbGQ8YW55LCBhbnk+IHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgbmFtZSA9IGZpZWxkQVNULm5hbWUudmFsdWU7XG4gIGlmIChuYW1lID09PSBTY2hlbWFNZXRhRmllbGREZWYubmFtZSAmJiBzY2hlbWEuZ2V0UXVlcnlUeXBlKCkgPT09IHBhcmVudFR5cGUpIHtcbiAgICByZXR1cm4gU2NoZW1hTWV0YUZpZWxkRGVmO1xuICB9XG4gIGlmIChuYW1lID09PSBUeXBlTWV0YUZpZWxkRGVmLm5hbWUgJiYgc2NoZW1hLmdldFF1ZXJ5VHlwZSgpID09PSBwYXJlbnRUeXBlKSB7XG4gICAgcmV0dXJuIFR5cGVNZXRhRmllbGREZWY7XG4gIH1cbiAgaWYgKFxuICAgIG5hbWUgPT09IFR5cGVOYW1lTWV0YUZpZWxkRGVmLm5hbWUgJiZcbiAgICAocGFyZW50VHlwZSBpbnN0YW5jZW9mIEdyYXBoUUxPYmplY3RUeXBlIHx8XG4gICAgICBwYXJlbnRUeXBlIGluc3RhbmNlb2YgR3JhcGhRTEludGVyZmFjZVR5cGUgfHxcbiAgICAgIHBhcmVudFR5cGUgaW5zdGFuY2VvZiBHcmFwaFFMVW5pb25UeXBlKVxuICApIHtcbiAgICByZXR1cm4gVHlwZU5hbWVNZXRhRmllbGREZWY7XG4gIH1cbiAgaWYgKHBhcmVudFR5cGUgaW5zdGFuY2VvZiBHcmFwaFFMT2JqZWN0VHlwZSB8fCBwYXJlbnRUeXBlIGluc3RhbmNlb2YgR3JhcGhRTEludGVyZmFjZVR5cGUpIHtcbiAgICByZXR1cm4gcGFyZW50VHlwZS5nZXRGaWVsZHMoKVtuYW1lXTtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9