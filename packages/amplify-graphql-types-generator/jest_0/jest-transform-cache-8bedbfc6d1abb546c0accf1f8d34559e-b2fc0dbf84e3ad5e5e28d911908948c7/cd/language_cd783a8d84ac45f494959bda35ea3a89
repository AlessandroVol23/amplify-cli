3897899f8e6b92074bd047e517de54f2
'use strict';require('ts-jest').install("/c/Users/Sandro/repo/amplify-cli/packages/amplify-graphql-types-generator/src/typescript/language.ts", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codeGeneration_1 = require(\"./codeGeneration\");\nconst types_1 = require(\"./types\");\nfunction interfaceDeclaration(generator, { interfaceName, noBrackets }, closure) {\n    generator.printNewlineIfNeeded();\n    generator.printNewline();\n    generator.print(`export type ${interfaceName} = `);\n    generator.pushScope({ typeName: interfaceName });\n    if (noBrackets) {\n        generator.withinBlock(closure, '', '');\n    }\n    else {\n        generator.withinBlock(closure, '{', '}');\n    }\n    generator.popScope();\n    generator.print(';');\n}\nexports.interfaceDeclaration = interfaceDeclaration;\nfunction propertyDeclaration(generator, { fieldName, type, propertyName, typeName, description, isInput, isArray, isNullable, isArrayElementNullable }, closure) {\n    const name = fieldName || propertyName;\n    if (description) {\n        description.split('\\n')\n            .forEach(line => {\n            generator.printOnNewline(`// ${line.trim()}`);\n        });\n    }\n    if (closure) {\n        generator.printOnNewline(name);\n        if (isNullable && isInput) {\n            generator.print('?');\n        }\n        generator.print(': ');\n        if (isArray) {\n            generator.print(' Array<');\n        }\n        generator.pushScope({ typeName: name });\n        generator.withinBlock(closure);\n        generator.popScope();\n        if (isArray) {\n            if (isArrayElementNullable) {\n                generator.print(' | null');\n            }\n            generator.print(' >');\n        }\n        if (isNullable) {\n            generator.print(' | null');\n        }\n    }\n    else {\n        generator.printOnNewline(name);\n        if (isInput && isNullable) {\n            generator.print('?');\n        }\n        generator.print(`: ${typeName || type && types_1.typeNameFromGraphQLType(generator.context, type)}`);\n    }\n    generator.print(',');\n}\nexports.propertyDeclaration = propertyDeclaration;\nfunction propertySetsDeclaration(generator, property, propertySets, standalone = false) {\n    const { description, fieldName, propertyName, isNullable, isArray, isArrayElementNullable, } = property;\n    const name = fieldName || propertyName;\n    if (description) {\n        description.split('\\n')\n            .forEach(line => {\n            generator.printOnNewline(`// ${line.trim()}`);\n        });\n    }\n    if (!standalone) {\n        generator.printOnNewline(`${name}: `);\n    }\n    if (isArray) {\n        generator.print(' Array<');\n    }\n    generator.pushScope({ typeName: name });\n    generator.withinBlock(() => {\n        propertySets.forEach((propertySet, index, propertySets) => {\n            generator.withinBlock(() => {\n                codeGeneration_1.propertyDeclarations(generator, propertySet);\n            });\n            if (index !== propertySets.length - 1) {\n                generator.print(' |');\n            }\n        });\n    }, '(', ')');\n    generator.popScope();\n    if (isArray) {\n        if (isArrayElementNullable) {\n            generator.print(' | null');\n        }\n        generator.print(' >');\n    }\n    if (isNullable) {\n        generator.print(' | null');\n    }\n    if (!standalone) {\n        generator.print(',');\n    }\n}\nexports.propertySetsDeclaration = propertySetsDeclaration;\nfunction methodDeclaration(generator, { methodName, returnType, async, args, }, closure) {\n    generator.printNewline();\n    if (async)\n        generator.print('async ');\n    generator.print(`${methodName}(${args.join(', ')}):${returnType}`);\n    generator.pushScope({ methodName });\n    generator.withinBlock(closure, '{', '}');\n    generator.popScope();\n}\nexports.methodDeclaration = methodDeclaration;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZ3VhZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsYW5ndWFnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLHFEQUF3RDtBQUN4RCxtQ0FBa0Q7QUF3QmxELDhCQUFxQyxTQUF3QixFQUFFLEVBQzdELGFBQWEsRUFDYixVQUFVLEVBQ3NDLEVBQ2hELE9BQW1CO0lBQ25CLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO0lBQ2pDLFNBQVMsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN6QixTQUFTLENBQUMsS0FBSyxDQUFDLGVBQWUsYUFBYSxLQUFLLENBQUMsQ0FBQztJQUNuRCxTQUFTLENBQUMsU0FBUyxDQUFDLEVBQUUsUUFBUSxFQUFFLGFBQWEsRUFBRSxDQUFDLENBQUM7SUFDakQsSUFBSSxVQUFVLEVBQUU7UUFDZCxTQUFTLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDeEM7U0FBTTtRQUNMLFNBQVMsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztLQUMxQztJQUNELFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNyQixTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZCLENBQUM7QUFoQkQsb0RBZ0JDO0FBRUQsNkJBQW9DLFNBQXdCLEVBQUUsRUFDNUQsU0FBUyxFQUNULElBQUksRUFDSixZQUFZLEVBQ1osUUFBUSxFQUNSLFdBQVcsRUFDWCxPQUFPLEVBQ1AsT0FBTyxFQUNQLFVBQVUsRUFDVixzQkFBc0IsRUFDYixFQUFFLE9BQW9CO0lBQy9CLE1BQU0sSUFBSSxHQUFHLFNBQVMsSUFBSSxZQUFZLENBQUM7SUFFdkMsSUFBSSxXQUFXLEVBQUU7UUFDZixXQUFXLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQzthQUNwQixPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDZCxTQUFTLENBQUMsY0FBYyxD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dCB9IGZyb20gJy4uL2NvbXBpbGVyL2xlZ2FjeUlSJztcblxuaW1wb3J0IHsgcHJvcGVydHlEZWNsYXJhdGlvbnMgfSBmcm9tICcuL2NvZGVHZW5lcmF0aW9uJztcbmltcG9ydCB7IHR5cGVOYW1lRnJvbUdyYXBoUUxUeXBlIH0gZnJvbSAnLi90eXBlcyc7XG5cbmltcG9ydCBDb2RlR2VuZXJhdG9yIGZyb20gXCIuLi91dGlsaXRpZXMvQ29kZUdlbmVyYXRvclwiO1xuaW1wb3J0IHsgR3JhcGhRTFR5cGUgfSBmcm9tIFwiZ3JhcGhxbFwiO1xuaW1wb3J0IE1heWJlIGZyb20gJ2dyYXBocWwvdHN1dGlscy9NYXliZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvcGVydHkge1xuICBmaWVsZE5hbWU/OiBzdHJpbmcsXG4gIGZpZWxkVHlwZT86IEdyYXBoUUxUeXBlLFxuICBwcm9wZXJ0eU5hbWU/OiBzdHJpbmcsXG4gIHR5cGU/OiBHcmFwaFFMVHlwZSxcbiAgZGVzY3JpcHRpb24/OiBNYXliZTxzdHJpbmc+LFxuICB0eXBlTmFtZT86IHN0cmluZyxcbiAgaXNDb21wb3NpdGU/OiBib29sZWFuLFxuICBpc051bGxhYmxlPzogYm9vbGVhbixcbiAgZmllbGRzPzogYW55W10sXG4gIGlubGluZUZyYWdtZW50cz86IExlZ2FjeUlubGluZUZyYWdtZW50W10sXG4gIGZyYWdtZW50U3ByZWFkcz86IGFueSxcbiAgaXNJbnB1dD86IGJvb2xlYW4sXG4gIGlzQXJyYXk/OiBib29sZWFuLFxuICBpc0FycmF5RWxlbWVudE51bGxhYmxlPzogYm9vbGVhbiB8IG51bGwsXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGludGVyZmFjZURlY2xhcmF0aW9uKGdlbmVyYXRvcjogQ29kZUdlbmVyYXRvciwge1xuICBpbnRlcmZhY2VOYW1lLFxuICBub0JyYWNrZXRzXG59OiB7IGludGVyZmFjZU5hbWU6IHN0cmluZywgbm9CcmFja2V0cz86IGJvb2xlYW4gfSxcbiAgY2xvc3VyZTogKCkgPT4gdm9pZCkge1xuICBnZW5lcmF0b3IucHJpbnROZXdsaW5lSWZOZWVkZWQoKTtcbiAgZ2VuZXJhdG9yLnByaW50TmV3bGluZSgpO1xuICBnZW5lcmF0b3IucHJpbnQoYGV4cG9ydCB0eXBlICR7aW50ZXJmYWNlTmFtZX0gPSBgKTtcbiAgZ2VuZXJhdG9yLnB1c2hTY29wZSh7IHR5cGVOYW1lOiBpbnRlcmZhY2VOYW1lIH0pO1xuICBpZiAobm9CcmFja2V0cykge1xuICAgIGdlbmVyYXRvci53aXRoaW5CbG9jayhjbG9zdXJlLCAnJywgJycpO1xuICB9IGVsc2Uge1xuICAgIGdlbmVyYXRvci53aXRoaW5CbG9jayhjbG9zdXJlLCAneycsICd9Jyk7XG4gIH1cbiAgZ2VuZXJhdG9yLnBvcFNjb3BlKCk7XG4gIGdlbmVyYXRvci5wcmludCgnOycpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJvcGVydHlEZWNsYXJhdGlvbihnZW5lcmF0b3I6IENvZGVHZW5lcmF0b3IsIHtcbiAgZmllbGROYW1lLFxuICB0eXBlLFxuICBwcm9wZXJ0eU5hbWUsXG4gIHR5cGVOYW1lLFxuICBkZXNjcmlwdGlvbixcbiAgaXNJbnB1dCxcbiAgaXNBcnJheSxcbiAgaXNOdWxsYWJsZSxcbiAgaXNBcnJheUVsZW1lbnROdWxsYWJsZVxufTogUHJvcGVydHksIGNsb3N1cmU/OiAoKSA9PiB2b2lkKSB7XG4gIGNvbnN0IG5hbWUgPSBmaWVsZE5hbWUgfHwgcHJvcGVydHlOYW1lO1xuXG4gIGlmIChkZXNjcmlwdGlvbikge1xuICAgIGRlc2NyaXB0aW9uLnNwbGl0KCdcXG4nKVxuICAgICAgLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgIGdlbmVyYXRvci5wcmludE9uTmV3bGluZShgLy8gJHtsaW5lLnRyaW0oKX1gKTtcbiAgICAgIH0pXG4gIH1cblxuICBpZiAoY2xvc3VyZSkge1xuICAgIGdlbmVyYXRvci5wcmludE9uTmV3bGluZShuYW1lKTtcblxuICAgIGlmIChpc051bGxhYmxlICYmIGlzSW5wdXQpIHtcbiAgICAgIGdlbmVyYXRvci5wcmludCgnPycpO1xuICAgIH1cbiAgICBnZW5lcmF0b3IucHJpbnQoJzogJyk7XG5cbiAgICBpZiAoaXNBcnJheSkge1xuICAgICAgZ2VuZXJhdG9yLnByaW50KCcgQXJyYXk8Jyk7XG4gICAgfVxuICAgIGdlbmVyYXRvci5wdXNoU2NvcGUoeyB0eXBlTmFtZTogbmFtZSB9KTtcblxuICAgIGdlbmVyYXRvci53aXRoaW5CbG9jayhjbG9zdXJlKTtcblxuICAgIGdlbmVyYXRvci5wb3BTY29wZSgpO1xuXG4gICAgaWYgKGlzQXJyYXkpIHtcbiAgICAgIGlmIChpc0FycmF5RWxlbWVudE51bGxhYmxlKSB7XG4gICAgICAgIGdlbmVyYXRvci5wcmludCgnIHwgbnVsbCcpO1xuICAgICAgfVxuICAgICAgZ2VuZXJhdG9yLnByaW50KCcgPicpO1xuICAgIH1cblxuICAgIGlmIChpc051bGxhYmxlKSB7XG4gICAgICBnZW5lcmF0b3IucHJpbnQoJyB8IG51bGwnKTtcbiAgICB9XG5cbiAgfSBlbHNlIHtcbiAgICBnZW5lcmF0b3IucHJpbnRPbk5ld2xpbmUobmFtZSk7XG4gICAgaWYgKGlzSW5wdXQgJiYgaXNOdWxsYWJsZSkge1xuICAgICAgZ2VuZXJhdG9yLnByaW50KCc/JylcbiAgICB9XG4gICAgZ2VuZXJhdG9yLnByaW50KGA6ICR7dHlwZU5hbWUgfHwgdHlwZSAmJiB0eXBlTmFtZUZyb21HcmFwaFFMVHlwZShnZW5lcmF0b3IuY29udGV4dCwgdHlwZSl9YCk7XG4gIH1cbiAgZ2VuZXJhdG9yLnByaW50KCcsJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9wZXJ0eVNldHNEZWNsYXJhdGlvbihnZW5lcmF0b3I6IENvZGVHZW5lcmF0b3IsIHByb3BlcnR5OiBQcm9wZXJ0eSwgcHJvcGVydHlTZXRzOiBQcm9wZXJ0eVtdW10sIHN0YW5kYWxvbmUgPSBmYWxzZSkge1xuICBjb25zdCB7XG4gICAgZGVzY3JpcHRpb24sIGZpZWxkTmFtZSwgcHJvcGVydHlOYW1lLFxuICAgIGlzTnVsbGFibGUsIGlzQXJyYXksIGlzQXJyYXlFbGVtZW50TnVsbGFibGUsXG4gIH0gPSBwcm9wZXJ0eTtcbiAgY29uc3QgbmFtZSA9IGZpZWxkTmFtZSB8fCBwcm9wZXJ0eU5hbWU7XG5cbiAgaWYgKGRlc2NyaXB0aW9uKSB7XG4gICAgZGVzY3JpcHRpb24uc3BsaXQoJ1xcbicpXG4gICAgICAuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgZ2VuZXJhdG9yLnByaW50T25OZXdsaW5lKGAvLyAke2xpbmUudHJpbSgpfWApO1xuICAgICAgfSlcbiAgfVxuXG4gIGlmICghc3RhbmRhbG9uZSkge1xuICAgIGdlbmVyYXRvci5wcmludE9uTmV3bGluZShgJHtuYW1lfTogYCk7XG4gIH1cblxuICBpZiAoaXNBcnJheSkge1xuICAgIGdlbmVyYXRvci5wcmludCgnIEFycmF5PCcpO1xuICB9XG5cbiAgZ2VuZXJhdG9yLnB1c2hTY29wZSh7IHR5cGVOYW1lOiBuYW1lIH0pO1xuXG4gIGdlbmVyYXRvci53aXRoaW5CbG9jaygoKSA9PiB7XG4gICAgcHJvcGVydHlTZXRzLmZvckVhY2goKHByb3BlcnR5U2V0LCBpbmRleCwgcHJvcGVydHlTZXRzKSA9PiB7XG4gICAgICBnZW5lcmF0b3Iud2l0aGluQmxvY2soKCkgPT4ge1xuICAgICAgICBwcm9wZXJ0eURlY2xhcmF0aW9ucyhnZW5lcmF0b3IsIHByb3BlcnR5U2V0KTtcbiAgICAgIH0pO1xuICAgICAgaWYgKGluZGV4ICE9PSBwcm9wZXJ0eVNldHMubGVuZ3RoIC0gMSkge1xuICAgICAgICBnZW5lcmF0b3IucHJpbnQoJyB8Jyk7XG4gICAgICB9XG4gICAgfSlcbiAgfSwgJygnLCAnKScpO1xuXG4gIGdlbmVyYXRvci5wb3BTY29wZSgpO1xuXG4gIGlmIChpc0FycmF5KSB7XG4gICAgaWYgKGlzQXJyYXlFbGVtZW50TnVsbGFibGUpIHtcbiAgICAgIGdlbmVyYXRvci5wcmludCgnIHwgbnVsbCcpO1xuICAgIH1cbiAgICBnZW5lcmF0b3IucHJpbnQoJyA+Jyk7XG4gIH1cblxuICBpZiAoaXNOdWxsYWJsZSkge1xuICAgIGdlbmVyYXRvci5wcmludCgnIHwgbnVsbCcpO1xuICB9XG5cbiAgaWYgKCFzdGFuZGFsb25lKSB7XG4gICAgZ2VuZXJhdG9yLnByaW50KCcsJyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ldGhvZERlY2xhcmF0aW9uKGdlbmVyYXRvcjogQ29kZUdlbmVyYXRvciwge1xuICBtZXRob2ROYW1lLFxuICByZXR1cm5UeXBlLFxuICBhc3luYyxcbiAgYXJncyxcbn06IHtcbiAgbWV0aG9kTmFtZTpzdHJpbmcsXG4gIHJldHVyblR5cGU6IHN0cmluZyxcbiAgYXN5bmM6IGJvb2xlYW4sXG4gIGFyZ3M6IEFycmF5PHN0cmluZz5cbn0sIGNsb3N1cmU6ICgpID0+IHZvaWQpIHtcbiAgZ2VuZXJhdG9yLnByaW50TmV3bGluZSgpO1xuICBpZiAoYXN5bmMpIGdlbmVyYXRvci5wcmludCgnYXN5bmMgJyk7XG4gIGdlbmVyYXRvci5wcmludChgJHttZXRob2ROYW1lfSgke2FyZ3Muam9pbignLCAnKX0pOiR7cmV0dXJuVHlwZX1gKTtcbiAgZ2VuZXJhdG9yLnB1c2hTY29wZSh7IG1ldGhvZE5hbWUgfSk7XG4gIGdlbmVyYXRvci53aXRoaW5CbG9jayhjbG9zdXJlLCAneycsICd9Jyk7XG4gIGdlbmVyYXRvci5wb3BTY29wZSgpO1xufSJdfQ==");"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const codeGeneration_1 = require("./codeGeneration");
const types_1 = require("./types");
function interfaceDeclaration(generator, { interfaceName, noBrackets }, closure) {
    generator.printNewlineIfNeeded();
    generator.printNewline();
    generator.print(`export type ${interfaceName} = `);
    generator.pushScope({ typeName: interfaceName });
    if (noBrackets) {
        generator.withinBlock(closure, '', '');
    } else
    {
        generator.withinBlock(closure, '{', '}');
    }
    generator.popScope();
    generator.print(';');
}
exports.interfaceDeclaration = interfaceDeclaration;
function propertyDeclaration(generator, { fieldName, type, propertyName, typeName, description, isInput, isArray, isNullable, isArrayElementNullable }, closure) {
    const name = fieldName || propertyName;
    if (description) {
        description.split('\n').
        forEach(line => {
            generator.printOnNewline(`// ${line.trim()}`);
        });
    }
    if (closure) {
        generator.printOnNewline(name);
        if (isNullable && isInput) {
            generator.print('?');
        }
        generator.print(': ');
        if (isArray) {
            generator.print(' Array<');
        }
        generator.pushScope({ typeName: name });
        generator.withinBlock(closure);
        generator.popScope();
        if (isArray) {
            if (isArrayElementNullable) {
                generator.print(' | null');
            }
            generator.print(' >');
        }
        if (isNullable) {
            generator.print(' | null');
        }
    } else
    {
        generator.printOnNewline(name);
        if (isInput && isNullable) {
            generator.print('?');
        }
        generator.print(`: ${typeName || type && types_1.typeNameFromGraphQLType(generator.context, type)}`);
    }
    generator.print(',');
}
exports.propertyDeclaration = propertyDeclaration;
function propertySetsDeclaration(generator, property, propertySets, standalone = false) {
    const { description, fieldName, propertyName, isNullable, isArray, isArrayElementNullable } = property;
    const name = fieldName || propertyName;
    if (description) {
        description.split('\n').
        forEach(line => {
            generator.printOnNewline(`// ${line.trim()}`);
        });
    }
    if (!standalone) {
        generator.printOnNewline(`${name}: `);
    }
    if (isArray) {
        generator.print(' Array<');
    }
    generator.pushScope({ typeName: name });
    generator.withinBlock(() => {
        propertySets.forEach((propertySet, index, propertySets) => {
            generator.withinBlock(() => {
                codeGeneration_1.propertyDeclarations(generator, propertySet);
            });
            if (index !== propertySets.length - 1) {
                generator.print(' |');
            }
        });
    }, '(', ')');
    generator.popScope();
    if (isArray) {
        if (isArrayElementNullable) {
            generator.print(' | null');
        }
        generator.print(' >');
    }
    if (isNullable) {
        generator.print(' | null');
    }
    if (!standalone) {
        generator.print(',');
    }
}
exports.propertySetsDeclaration = propertySetsDeclaration;
function methodDeclaration(generator, { methodName, returnType, async, args }, closure) {
    generator.printNewline();
    if (async)
    generator.print('async ');
    generator.print(`${methodName}(${args.join(', ')}):${returnType}`);
    generator.pushScope({ methodName });
    generator.withinBlock(closure, '{', '}');
    generator.popScope();
}
exports.methodDeclaration = methodDeclaration;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBVXNCO0FBQ3BCLGNBQVUsWUFBVjtBQUNBLFFBQUksS0FBSjtBQUFXLGNBQVUsS0FBVixDQUFnQixRQUFoQjtBQUNYLGNBQVUsS0FBVixDQUFnQixHQUFHLFVBQVUsSUFBSSxLQUFLLElBQUwsQ0FBVSxJQUFWLENBQWUsS0FBSyxVQUFVLEVBQS9EO0FBQ0EsY0FBVSxTQUFWLENBQW9CLEVBQUUsVUFBRixFQUFwQjtBQUNBLGNBQVUsV0FBVixDQUFzQixPQUF0QixFQUErQixHQUEvQixFQUFvQyxHQUFwQztBQUNBLGNBQVUsUUFBVjtBQUNEO0FBakJELFFBQUEsaUJBQUEsR0FBQSxpQkFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExlZ2FjeUlubGluZUZyYWdtZW50IH0gZnJvbSAnLi4vY29tcGlsZXIvbGVnYWN5SVInO1xuXG5pbXBvcnQgeyBwcm9wZXJ0eURlY2xhcmF0aW9ucyB9IGZyb20gJy4vY29kZUdlbmVyYXRpb24nO1xuaW1wb3J0IHsgdHlwZU5hbWVGcm9tR3JhcGhRTFR5cGUgfSBmcm9tICcuL3R5cGVzJztcblxuaW1wb3J0IENvZGVHZW5lcmF0b3IgZnJvbSBcIi4uL3V0aWxpdGllcy9Db2RlR2VuZXJhdG9yXCI7XG5pbXBvcnQgeyBHcmFwaFFMVHlwZSB9IGZyb20gXCJncmFwaHFsXCI7XG5pbXBvcnQgTWF5YmUgZnJvbSAnZ3JhcGhxbC90c3V0aWxzL01heWJlJztcblxuZXhwb3J0IGludGVyZmFjZSBQcm9wZXJ0eSB7XG4gIGZpZWxkTmFtZT86IHN0cmluZyxcbiAgZmllbGRUeXBlPzogR3JhcGhRTFR5cGUsXG4gIHByb3BlcnR5TmFtZT86IHN0cmluZyxcbiAgdHlwZT86IEdyYXBoUUxUeXBlLFxuICBkZXNjcmlwdGlvbj86IE1heWJlPHN0cmluZz4sXG4gIHR5cGVOYW1lPzogc3RyaW5nLFxuICBpc0NvbXBvc2l0ZT86IGJvb2xlYW4sXG4gIGlzTnVsbGFibGU/OiBib29sZWFuLFxuICBmaWVsZHM/OiBhbnlbXSxcbiAgaW5saW5lRnJhZ21lbnRzPzogTGVnYWN5SW5saW5lRnJhZ21lbnRbXSxcbiAgZnJhZ21lbnRTcHJlYWRzPzogYW55LFxuICBpc0lucHV0PzogYm9vbGVhbixcbiAgaXNBcnJheT86IGJvb2xlYW4sXG4gIGlzQXJyYXlFbGVtZW50TnVsbGFibGU/OiBib29sZWFuIHwgbnVsbCxcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJmYWNlRGVjbGFyYXRpb24oZ2VuZXJhdG9yOiBDb2RlR2VuZXJhdG9yLCB7XG4gIGludGVyZmFjZU5hbWUsXG4gIG5vQnJhY2tldHNcbn06IHsgaW50ZXJmYWNlTmFtZTogc3RyaW5nLCBub0JyYWNrZXRzPzogYm9vbGVhbiB9LFxuICBjbG9zdXJlOiAoKSA9PiB2b2lkKSB7XG4gIGdlbmVyYXRvci5wcmludE5ld2xpbmVJZk5lZWRlZCgpO1xuICBnZW5lcmF0b3IucHJpbnROZXdsaW5lKCk7XG4gIGdlbmVyYXRvci5wcmludChgZXhwb3J0IHR5cGUgJHtpbnRlcmZhY2VOYW1lfSA9IGApO1xuICBnZW5lcmF0b3IucHVzaFNjb3BlKHsgdHlwZU5hbWU6IGludGVyZmFjZU5hbWUgfSk7XG4gIGlmIChub0JyYWNrZXRzKSB7XG4gICAgZ2VuZXJhdG9yLndpdGhpbkJsb2NrKGNsb3N1cmUsICcnLCAnJyk7XG4gIH0gZWxzZSB7XG4gICAgZ2VuZXJhdG9yLndpdGhpbkJsb2NrKGNsb3N1cmUsICd7JywgJ30nKTtcbiAgfVxuICBnZW5lcmF0b3IucG9wU2NvcGUoKTtcbiAgZ2VuZXJhdG9yLnByaW50KCc7Jyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9wZXJ0eURlY2xhcmF0aW9uKGdlbmVyYXRvcjogQ29kZUdlbmVyYXRvciwge1xuICBmaWVsZE5hbWUsXG4gIHR5cGUsXG4gIHByb3BlcnR5TmFtZSxcbiAgdHlwZU5hbWUsXG4gIGRlc2NyaXB0aW9uLFxuICBpc0lucHV0LFxuICBpc0FycmF5LFxuICBpc051bGxhYmxlLFxuICBpc0FycmF5RWxlbWVudE51bGxhYmxlXG59OiBQcm9wZXJ0eSwgY2xvc3VyZT86ICgpID0+IHZvaWQpIHtcbiAgY29uc3QgbmFtZSA9IGZpZWxkTmFtZSB8fCBwcm9wZXJ0eU5hbWU7XG5cbiAgaWYgKGRlc2NyaXB0aW9uKSB7XG4gICAgZGVzY3JpcHRpb24uc3BsaXQoJ1xcbicpXG4gICAgICAuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgZ2VuZXJhdG9yLnByaW50T25OZXdsaW5lKGAvLyAke2xpbmUudHJpbSgpfWApO1xuICAgICAgfSlcbiAgfVxuXG4gIGlmIChjbG9zdXJlKSB7XG4gICAgZ2VuZXJhdG9yLnByaW50T25OZXdsaW5lKG5hbWUpO1xuXG4gICAgaWYgKGlzTnVsbGFibGUgJiYgaXNJbnB1dCkge1xuICAgICAgZ2VuZXJhdG9yLnByaW50KCc/Jyk7XG4gICAgfVxuICAgIGdlbmVyYXRvci5wcmludCgnOiAnKTtcblxuICAgIGlmIChpc0FycmF5KSB7XG4gICAgICBnZW5lcmF0b3IucHJpbnQoJyBBcnJheTwnKTtcbiAgICB9XG4gICAgZ2VuZXJhdG9yLnB1c2hTY29wZSh7IHR5cGVOYW1lOiBuYW1lIH0pO1xuXG4gICAgZ2VuZXJhdG9yLndpdGhpbkJsb2NrKGNsb3N1cmUpO1xuXG4gICAgZ2VuZXJhdG9yLnBvcFNjb3BlKCk7XG5cbiAgICBpZiAoaXNBcnJheSkge1xuICAgICAgaWYgKGlzQXJyYXlFbGVtZW50TnVsbGFibGUpIHtcbiAgICAgICAgZ2VuZXJhdG9yLnByaW50KCcgfCBudWxsJyk7XG4gICAgICB9XG4gICAgICBnZW5lcmF0b3IucHJpbnQoJyA+Jyk7XG4gICAgfVxuXG4gICAgaWYgKGlzTnVsbGFibGUpIHtcbiAgICAgIGdlbmVyYXRvci5wcmludCgnIHwgbnVsbCcpO1xuICAgIH1cblxuICB9IGVsc2Uge1xuICAgIGdlbmVyYXRvci5wcmludE9uTmV3bGluZShuYW1lKTtcbiAgICBpZiAoaXNJbnB1dCAmJiBpc051bGxhYmxlKSB7XG4gICAgICBnZW5lcmF0b3IucHJpbnQoJz8nKVxuICAgIH1cbiAgICBnZW5lcmF0b3IucHJpbnQoYDogJHt0eXBlTmFtZSB8fCB0eXBlICYmIHR5cGVOYW1lRnJvbUdyYXBoUUxUeXBlKGdlbmVyYXRvci5jb250ZXh0LCB0eXBlKX1gKTtcbiAgfVxuICBnZW5lcmF0b3IucHJpbnQoJywnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb3BlcnR5U2V0c0RlY2xhcmF0aW9uKGdlbmVyYXRvcjogQ29kZUdlbmVyYXRvciwgcHJvcGVydHk6IFByb3BlcnR5LCBwcm9wZXJ0eVNldHM6IFByb3BlcnR5W11bXSwgc3RhbmRhbG9uZSA9IGZhbHNlKSB7XG4gIGNvbnN0IHtcbiAgICBkZXNjcmlwdGlvbiwgZmllbGROYW1lLCBwcm9wZXJ0eU5hbWUsXG4gICAgaXNOdWxsYWJsZSwgaXNBcnJheSwgaXNBcnJheUVsZW1lbnROdWxsYWJsZSxcbiAgfSA9IHByb3BlcnR5O1xuICBjb25zdCBuYW1lID0gZmllbGROYW1lIHx8IHByb3BlcnR5TmFtZTtcblxuICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICBkZXNjcmlwdGlvbi5zcGxpdCgnXFxuJylcbiAgICAgIC5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICBnZW5lcmF0b3IucHJpbnRPbk5ld2xpbmUoYC8vICR7bGluZS50cmltKCl9YCk7XG4gICAgICB9KVxuICB9XG5cbiAgaWYgKCFzdGFuZGFsb25lKSB7XG4gICAgZ2VuZXJhdG9yLnByaW50T25OZXdsaW5lKGAke25hbWV9OiBgKTtcbiAgfVxuXG4gIGlmIChpc0FycmF5KSB7XG4gICAgZ2VuZXJhdG9yLnByaW50KCcgQXJyYXk8Jyk7XG4gIH1cblxuICBnZW5lcmF0b3IucHVzaFNjb3BlKHsgdHlwZU5hbWU6IG5hbWUgfSk7XG5cbiAgZ2VuZXJhdG9yLndpdGhpbkJsb2NrKCgpID0+IHtcbiAgICBwcm9wZXJ0eVNldHMuZm9yRWFjaCgocHJvcGVydHlTZXQsIGluZGV4LCBwcm9wZXJ0eVNldHMpID0+IHtcbiAgICAgIGdlbmVyYXRvci53aXRoaW5CbG9jaygoKSA9PiB7XG4gICAgICAgIHByb3BlcnR5RGVjbGFyYXRpb25zKGdlbmVyYXRvciwgcHJvcGVydHlTZXQpO1xuICAgICAgfSk7XG4gICAgICBpZiAoaW5kZXggIT09IHByb3BlcnR5U2V0cy5sZW5ndGggLSAxKSB7XG4gICAgICAgIGdlbmVyYXRvci5wcmludCgnIHwnKTtcbiAgICAgIH1cbiAgICB9KVxuICB9LCAnKCcsICcpJyk7XG5cbiAgZ2VuZXJhdG9yLnBvcFNjb3BlKCk7XG5cbiAgaWYgKGlzQXJyYXkpIHtcbiAgICBpZiAoaXNBcnJheUVsZW1lbnROdWxsYWJsZSkge1xuICAgICAgZ2VuZXJhdG9yLnByaW50KCcgfCBudWxsJyk7XG4gICAgfVxuICAgIGdlbmVyYXRvci5wcmludCgnID4nKTtcbiAgfVxuXG4gIGlmIChpc051bGxhYmxlKSB7XG4gICAgZ2VuZXJhdG9yLnByaW50KCcgfCBudWxsJyk7XG4gIH1cblxuICBpZiAoIXN0YW5kYWxvbmUpIHtcbiAgICBnZW5lcmF0b3IucHJpbnQoJywnKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWV0aG9kRGVjbGFyYXRpb24oZ2VuZXJhdG9yOiBDb2RlR2VuZXJhdG9yLCB7XG4gIG1ldGhvZE5hbWUsXG4gIHJldHVyblR5cGUsXG4gIGFzeW5jLFxuICBhcmdzLFxufToge1xuICBtZXRob2ROYW1lOnN0cmluZyxcbiAgcmV0dXJuVHlwZTogc3RyaW5nLFxuICBhc3luYzogYm9vbGVhbixcbiAgYXJnczogQXJyYXk8c3RyaW5nPlxufSwgY2xvc3VyZTogKCkgPT4gdm9pZCkge1xuICBnZW5lcmF0b3IucHJpbnROZXdsaW5lKCk7XG4gIGlmIChhc3luYykgZ2VuZXJhdG9yLnByaW50KCdhc3luYyAnKTtcbiAgZ2VuZXJhdG9yLnByaW50KGAke21ldGhvZE5hbWV9KCR7YXJncy5qb2luKCcsICcpfSk6JHtyZXR1cm5UeXBlfWApO1xuICBnZW5lcmF0b3IucHVzaFNjb3BlKHsgbWV0aG9kTmFtZSB9KTtcbiAgZ2VuZXJhdG9yLndpdGhpbkJsb2NrKGNsb3N1cmUsICd7JywgJ30nKTtcbiAgZ2VuZXJhdG9yLnBvcFNjb3BlKCk7XG59Il0sInNvdXJjZVJvb3QiOiIifQ==